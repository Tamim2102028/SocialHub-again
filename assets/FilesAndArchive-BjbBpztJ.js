import{j as e,U as A,f as me,r as h,bx as L,H as he,av as Z,E as I,b as R,by as J,bz as Y,bA as _,aP as M,ay as se,O as te,bB as ue,bC as ge,P as ae,bD as pe,bE as be,bF as fe,bG as je,bH as ve,bI as ye,Q as B,S as H,c as w,bJ as Ne,bK as we,bL as Fe,W as Ce,at as le,aG as ke,aF as Se,bM as De,bN as $e,bO as Te,bP as Ie,bQ as Pe,bR as O,ah as Le,y as re,bS as Ae,o as Ue,bT as E,bU as Ee,bV as Me,bW as Be,bX as ze,bg as Oe,x as Re,bY as Ge,bZ as Qe,b_ as He,b$ as Ve,c0 as Xe,c1 as We,c2 as Ke,c3 as Ze,c4 as Je,c5 as Ye,c6 as _e,c7 as qe,c8 as es,c9 as ss,ca as ts,cb as as,cc as ls,cd as rs,ce as ns,cf as os,cg as is}from"./index-CNnNJRga.js";import{i as ne,a as P,b as oe,d as ie,e as cs}from"./sweetAlert-CYyJlmlj.js";const U=({icon:l,label:d,onClick:a,className:n=""})=>e.jsxs("button",{onClick:a,className:`flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-600 transition-colors hover:bg-blue-100 hover:text-black ${n}`,children:[e.jsx(l,{className:"h-4 w-4"}),d]}),ds=({searchQuery:l,onSearchChange:d,onNewFolder:a,onUpload:n})=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(U,{icon:A,label:"New Folder",onClick:a}),e.jsx(U,{icon:A,label:"Upload File",onClick:n})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("div",{className:"relative",children:[e.jsx(me,{className:"absolute top-1/2 left-3 h-3 w-3 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search files...",className:"w-full rounded-md border border-blue-500 py-2 pr-3 pl-8 text-sm font-medium focus:ring-1 focus:ring-blue-500 focus:outline-none",value:l,onChange:x=>d(x.target.value)})]})})]}),ce=({currentPath:l,onNavigate:d})=>{const[a,n]=h.useState(!1),[x,i]=h.useState(!1),r=h.useRef(null);h.useEffect(()=>{const g=()=>{if(r.current){const m=r.current.scrollWidth>r.current.clientWidth;i(m)}};return g(),window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[l]);const b=()=>e.jsx("nav",{className:"flex items-center space-x-2 overflow-hidden text-sm",children:l.map((g,m)=>{const p=m===l.length-1;return e.jsx(Z.Fragment,{children:m===0?e.jsx("button",{onClick:()=>d(m),className:`flex h-[38px] items-center rounded-lg px-3 py-2 transition-all ${p&&l.length===1?"text-blue-600":"text-gray-600 hover:bg-gray-200"}`,children:e.jsx("span",{className:"max-w-[120px] truncate font-medium",children:g.name})}):e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"h-3 w-3 flex-shrink-0 text-gray-400"}),e.jsx("button",{onClick:()=>d(m),className:`h-[38px] rounded-lg px-3 py-2 whitespace-nowrap transition-all ${p?"text-blue-600":"text-gray-600 hover:bg-gray-200"}`,children:e.jsx("span",{className:"block max-w-[120px] truncate font-medium",children:g.name})})]})},g.id)})}),u=()=>{if(l.length<=3)return b();const g=l[0],m=l.slice(-2),p=l.slice(1,-2);return e.jsxs("nav",{className:"flex items-center space-x-2 text-sm",children:[e.jsx("button",{onClick:()=>d(0),className:"flex h-[38px] items-center rounded-lg px-3 py-2 whitespace-nowrap text-gray-600 transition-all hover:bg-gray-200",children:e.jsx("span",{className:"max-w-[120px] truncate font-medium",children:g.name})}),e.jsx(L,{className:"h-3 w-3 flex-shrink-0 text-gray-400"}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>n(!a),className:"flex h-[38px] items-center justify-center rounded-lg px-3 py-2 text-gray-600 transition-all hover:bg-gray-200",title:"Show hidden folders",children:e.jsx(he,{className:"h-3.5 w-3.5"})}),a&&e.jsx("div",{className:"absolute top-full left-0 z-10 mt-1 min-w-[200px] rounded-lg border border-gray-200 bg-white shadow-lg",children:e.jsx("div",{className:"py-1",children:p.map((y,F)=>e.jsx("button",{onClick:()=>{d(F+1),n(!1)},className:"w-full px-3 py-2 text-left text-sm font-medium text-gray-700 transition-colors hover:bg-gray-100",children:e.jsx("span",{className:"block truncate",children:y.name})},y.id))})})]}),m.map((y,F)=>{const S=l.length-2+F,s=S===l.length-1;return e.jsxs(Z.Fragment,{children:[e.jsx(L,{className:"h-3 w-3 flex-shrink-0 text-gray-400"}),e.jsx("button",{onClick:()=>d(S),className:`h-[38px] rounded-lg px-3 py-2 whitespace-nowrap transition-all ${s?"text-blue-600":"text-gray-600 hover:bg-gray-200"}`,children:e.jsx("span",{className:"block max-w-[120px] truncate font-medium",children:y.name})})]},y.id)})]})};return h.useEffect(()=>{const g=m=>{r.current&&!r.current.contains(m.target)&&n(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]),e.jsx("div",{ref:r,className:"min-w-0 flex-1",children:l.length>4||x?u():b()})},q=({searchQuery:l,onNewFolder:d,onUpload:a})=>e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-8 text-center",children:[e.jsx(I,{className:"mx-auto mb-3 text-4xl text-gray-300"}),e.jsx("h3",{className:"mb-2 text-base font-medium text-gray-900",children:l?"No files found":"This folder is empty"}),e.jsx("p",{className:"mb-4 text-sm text-gray-500",children:l?"Try adjusting your search terms.":"Upload files or create folders to get started."}),!l&&e.jsxs("div",{className:"flex justify-center space-x-3",children:[e.jsx(U,{icon:A,label:"New Folder",onClick:d}),e.jsx(U,{icon:A,label:"Upload File",onClick:a})]})]}),xs=({files:l,onFolderClick:d,getFileIcon:a,formatDate:n,formatTime:x})=>{const[i,r]=h.useState(null),b=h.useRef(null),u=R();h.useEffect(()=>{const s=D=>{b.current&&!b.current.contains(D.target)&&r(null)},o=D=>{D.key==="Escape"&&r(null)};if(i)return document.addEventListener("mousedown",s),document.addEventListener("keydown",o),()=>{document.removeEventListener("mousedown",s),document.removeEventListener("keydown",o)}},[i]);const g=async s=>{try{u(be(s.id));const o=`${window.location.origin}/files/${s.id}`;navigator.share?await navigator.share({title:s.name,text:`Check out this file: ${s.name}`,url:o}):(await navigator.clipboard.writeText(o),alert("NavLink copied to clipboard!"))}catch(o){console.error("Error sharing:",o),alert("Could not share the file")}},m=s=>{const o=document.createElement("a");o.href="#",o.download=s.name,document.body.appendChild(o),o.click(),document.body.removeChild(o),alert(`Downloading ${s.name}...`)},p=async s=>{const o=await ne(s.name);o&&o!==s.name&&(u(fe({itemId:s.id,newName:o})),P({title:"Renamed successfully!"}))},y=s=>{u(je(s.id))},F=async s=>{await oe(s.name)&&(u(ve(s.id)),P({title:"Deleted!",text:`${s.name} has been deleted.`}))},S=s=>{s.type==="folder"&&u(pe(s.id))};return e.jsxs("div",{className:"overflow-hidden rounded-lg border border-gray-200 bg-white",children:[e.jsx("div",{className:"divide-y divide-gray-200",children:l.map(s=>e.jsxs("div",{className:"group flex cursor-pointer items-center justify-between p-3 transition-colors hover:bg-gray-50",onClick:()=>s.type==="folder"?d(s.id,s.name):void 0,children:[e.jsxs("div",{className:"flex flex-1 items-center space-x-3",children:[e.jsx("div",{className:"text-xl",children:a(s)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"truncate text-sm font-medium text-gray-900",children:s.name}),s.shared&&e.jsx(J,{className:"h-4 w-4 text-blue-500"})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[n(s.createdAt)," • ",x(s.createdAt),s.size&&` • ${s.size}`]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[s.type==="folder"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:o=>{o.stopPropagation(),S(s)},className:`rounded p-2 transition-colors ${s.isPublic?"text-green-600 hover:bg-green-50":"text-gray-500 hover:bg-gray-100"}`,title:s.isPublic?"Make folder private":"Make folder public",children:s.isPublic?e.jsx(Y,{className:"h-4 w-4"}):e.jsx(_,{className:"h-4 w-4"})}),e.jsx("button",{onClick:o=>{o.stopPropagation(),alert(`Downloading ${s.name} folder as ZIP...`)},className:"rounded p-2 text-gray-500 transition-colors hover:bg-green-50 hover:text-green-600",title:"Download folder as ZIP",children:e.jsx(M,{className:"h-4 w-4"})})]}),s.type==="file"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:o=>{o.stopPropagation(),g(s)},className:"rounded p-2 text-gray-500 transition-colors hover:bg-blue-50 hover:text-blue-600",title:"Share file",children:e.jsx(J,{className:"h-4 w-4"})}),e.jsx("button",{onClick:o=>{o.stopPropagation(),m(s)},className:"rounded p-2 text-gray-500 transition-colors hover:bg-green-50 hover:text-green-600",title:"Download file",children:e.jsx(M,{className:"h-4 w-4"})})]}),e.jsx("button",{onClick:o=>{o.stopPropagation(),r(i===s.id?null:s.id)},className:"relative rounded p-2 text-gray-500 transition-colors hover:bg-gray-100 hover:text-gray-700",title:"More options",children:e.jsx(se,{className:"h-4 w-4"})})]})]},s.id))}),i&&e.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-center justify-center",onClick:()=>r(null),children:e.jsxs("div",{ref:b,className:"w-80 rounded-lg bg-white p-6 shadow-xl",onClick:s=>s.stopPropagation(),children:[e.jsx("h3",{className:"mb-4 text-lg font-semibold text-gray-900",children:"File Options"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>{const s=l.find(o=>o.id===i);s&&p(s),r(null)},className:"flex w-full items-center rounded-md px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-100",children:[e.jsx(te,{className:"mr-3 h-5 w-5"}),"Rename"]}),e.jsxs("button",{onClick:()=>{const s=l.find(o=>o.id===i);s&&y(s),r(null)},className:"flex w-full items-center rounded-md px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-100",children:[e.jsx(ue,{className:"mr-3 h-5 w-5"}),"Copy"]}),l.find(s=>s.id===i)?.type==="folder"&&e.jsx("button",{onClick:()=>{const s=l.find(o=>o.id===i);s&&S(s),r(null)},className:"flex w-full items-center rounded-md px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-100",children:l.find(s=>s.id===i)?.isPublic?e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"mr-3 h-5 w-5"}),"Make Private"]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"mr-3 h-5 w-5"}),"Make Public"]})}),l.find(s=>s.id===i)?.type==="file"&&e.jsxs("button",{onClick:()=>{const s=l.find(o=>o.id===i);s&&alert(`File info for ${s.name}
Size: ${s.size}
Created: ${n(s.createdAt)}
Shared: ${s.shared?"Yes":"No"}`),r(null)},className:"flex w-full items-center rounded-md px-4 py-3 text-sm font-medium text-gray-600 hover:bg-gray-100",children:[e.jsx(ge,{className:"mr-3 h-5 w-5"}),"Properties"]}),e.jsx("div",{className:"border-t border-gray-200 pt-2",children:e.jsxs("button",{onClick:()=>{const s=l.find(o=>o.id===i);s&&F(s),r(null)},className:"flex w-full items-center rounded-md px-4 py-3 text-sm font-medium text-red-700 hover:bg-red-50",children:[e.jsx(ae,{className:"mr-3 h-5 w-5"}),"Delete"]})}),e.jsx("div",{className:"border-t border-gray-200 pt-2",children:e.jsx("button",{onClick:()=>r(null),className:"flex w-full items-center justify-center rounded-md px-4 py-3 text-sm font-medium text-gray-500 hover:bg-gray-100",children:"Cancel"})})]})]})})]})},Q=({isOpen:l,onClose:d,onUploadFiles:a})=>{const[n,x]=h.useState([]),[i,r]=h.useState(!1),[b,u]=h.useState(""),g=h.useRef(null),m=h.useMemo(()=>100*1024*1024,[]),p=h.useMemo(()=>["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","image/jpeg","image/jpg","image/png","image/gif","text/plain","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],[]),y=h.useCallback(f=>{const C=[];let $="";for(const N of f){if(N.size>m){$=`${N.name} is too large. Maximum size is 100MB.`;break}if(!p.includes(N.type)&&!N.name.match(/\.(pdf|doc|docx|jpg|jpeg|png|gif|txt|xls|xlsx)$/i)){$=`${N.name} is not a supported file type.`;break}C.push(N)}return $?(u($),[]):(u(""),C)},[m,p]),F=h.useCallback(f=>{if(!f)return;const C=Array.from(f),$=y(C);$.length>0&&x(N=>[...N,...$])},[y]),S=h.useCallback(f=>{f.preventDefault(),r(!0)},[]),s=h.useCallback(f=>{f.preventDefault(),r(!1)},[]),o=h.useCallback(f=>{f.preventDefault(),r(!1),F(f.dataTransfer.files)},[F]),D=f=>{x(C=>C.filter(($,N)=>N!==f))},c=()=>{if(n.length===0){u("Please select at least one file to upload.");return}a(n),x([]),u(""),d()},k=()=>{x([]),u(""),r(!1),d()},T=f=>{if(f===0)return"0 Bytes";const C=1024,$=["Bytes","KB","MB","GB"],N=Math.floor(Math.log(f)/Math.log(C));return parseFloat((f/Math.pow(C,N)).toFixed(2))+" "+$[N]};return l?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center backdrop-blur-md",children:e.jsxs("div",{className:"mx-4 w-full max-w-lg transform rounded-xl bg-white p-6 shadow-2xl transition-all duration-300 ease-out",children:[e.jsx("h3",{className:"mb-4 text-lg font-semibold text-gray-900",children:"Upload Files"}),e.jsxs("div",{onClick:()=>g.current?.click(),onDragOver:S,onDragLeave:s,onDrop:o,className:`mb-4 cursor-pointer rounded-lg border-2 border-dashed p-8 text-center transition-all ${i?"border-blue-500 bg-blue-100":"border-blue-300 bg-blue-50 hover:border-blue-400 hover:bg-blue-100"}`,children:[e.jsx(ye,{className:"mx-auto mb-3 text-3xl text-blue-500"}),e.jsx("p",{className:"mb-2 text-sm font-medium text-gray-700",children:i?"Drop files here":"Drop files here or click to browse"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Supports: PDF, DOC, DOCX, JPG, PNG, GIF, TXT, XLS, XLSX (Max: 100MB)"})]}),e.jsx("input",{ref:g,type:"file",multiple:!0,onChange:f=>F(f.target.files),className:"hidden",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png,.gif,.txt,.xls,.xlsx"}),n.length>0&&e.jsxs("div",{className:"mb-4 max-h-40 overflow-y-auto",children:[e.jsxs("h4",{className:"mb-2 text-sm font-medium text-gray-700",children:["Selected Files (",n.length,")"]}),e.jsx("div",{className:"space-y-2",children:n.map((f,C)=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-gray-200 p-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{className:"text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:f.name}),e.jsx("p",{className:"text-xs text-gray-500",children:T(f.size)})]})]}),e.jsx("button",{onClick:()=>D(C),className:"rounded-full p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-600",children:e.jsx(H,{className:"h-3 w-3"})})]},C))})]}),b&&e.jsx("p",{className:"mb-4 text-sm text-red-600",children:b}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:k,className:"rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 transition-all hover:border-gray-400 hover:bg-gray-50",children:"Cancel"}),e.jsxs("button",{onClick:c,disabled:n.length===0,className:`rounded-lg px-4 py-2 text-sm font-medium text-white transition-all ${n.length>0?"bg-blue-600 hover:bg-blue-700 hover:shadow-md":"cursor-not-allowed bg-gray-400"}`,children:["Upload ",n.length>0?`${n.length} `:"","Files"]})]})]})}):null},ms=()=>{const l=R(),d=w(Ne),a=w(we),[n,x]=h.useState(!1),[i,r]=h.useState(""),b=(c,k)=>{l(Ie({id:c,name:k}))},u=c=>{l(Te(c))},g=()=>{l($e())},m=async()=>{const c=await ie();c&&(l(De(c)),P({title:"Folder created"}))},p=c=>{l(Pe(c))},y=w(Fe),F=w(c=>Ce(c,c.profile.id)),S=F?.university?.year,s=F?.university?.semester,o=c=>c.type==="folder"?e.jsx(I,{className:"h-5 w-5 text-blue-600"}):e.jsx(B,{className:"h-5 w-5 text-gray-600"}),D=[];for(let c=1;c<=4;c++)for(let k=1;k<=2;k++){const T=`level-${c}-term-${k}`;D.push({id:T,level:c,term:k})}return e.jsxs("div",{className:"space-y-3",children:[e.jsx(ds,{searchQuery:i,onSearchChange:r,onNewFolder:m,onUpload:()=>x(!0)}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:g,disabled:d.length===0,className:`flex h-[38px] items-center justify-center rounded-lg border border-gray-300 px-3 py-2 transition-colors ${d.length===0?"cursor-not-allowed bg-gray-100 text-gray-400":"bg-gray-100 text-gray-600 hover:bg-gray-200 hover:text-gray-800"}`,title:"Go back",children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx(ce,{currentPath:a,onNavigate:u})]}),e.jsx("div",{children:d.length===0?e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-4",children:D.filter(c=>`Level ${c.level} Term ${c.term}`.toLowerCase().includes(i.toLowerCase())).map(c=>{const k=`Level ${c.level} Term ${c.term}`,T=S===c.level&&s===c.term;return e.jsx("button",{onClick:()=>b(c.id,k),className:`flex transform flex-col items-start rounded-xl border p-4 shadow-sm transition-all duration-150 hover:shadow-md ${T?"border-blue-300 bg-green-50":"border-gray-200 bg-white"}`,"aria-label":`Open ${k}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex items-center justify-center rounded-lg bg-blue-100 p-3 text-blue-600",children:e.jsx(I,{className:"h-5 w-5"})}),e.jsxs("div",{className:"text-left",children:[e.jsxs("div",{className:`text-lg font-semibold ${T?"text-green-700":"text-gray-800"}`,children:["Level ",c.level]}),e.jsxs("div",{className:`text-sm font-semibold ${T?"text-green-600":"text-gray-600"}`,children:["Term ",c.term]})]})]})},c.id)})}),i&&D.filter(c=>`Level ${c.level} Term ${c.term}`.toLowerCase().includes(i.toLowerCase())).length===0&&e.jsx("div",{className:"mt-6",children:e.jsx(q,{searchQuery:i,onNewFolder:m,onUpload:()=>x(!0)})})]}):e.jsx("div",{children:y.length>0?e.jsx(xs,{files:y,onFolderClick:b,getFileIcon:c=>o(c),formatDate:Se,formatTime:ke}):e.jsx(q,{searchQuery:i,onNewFolder:m,onUpload:()=>x(!0)})})}),e.jsx(Q,{isOpen:n,onClose:()=>x(!1),onUploadFiles:p})]})},hs=({selectedLevel:l,setSelectedLevel:d,selectedTerm:a,setSelectedTerm:n,levels:x,terms:i})=>e.jsxs("div",{className:"flex justify-between rounded-lg border border-gray-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"rounded-lg bg-green-600 p-3 text-white",children:e.jsx(I,{className:"text-xl"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Study Archive"}),e.jsx("p",{className:"text-gray-600",children:"A collaborative library of academic resources."})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:l,onChange:r=>d(r.target.value),className:"appearance-none rounded-lg border border-gray-300 bg-white px-4 py-2 pr-8 focus:outline-none",children:x.map(r=>e.jsx("option",{value:r,children:r},r))}),e.jsx(O,{className:"pointer-events-none absolute top-3 right-2 text-gray-400"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:a,onChange:r=>n(r.target.value),className:"appearance-none rounded-lg border border-gray-300 bg-white px-4 py-2 pr-8 focus:outline-none",children:i.map(r=>e.jsx("option",{value:r,children:r},r))}),e.jsx(O,{className:"pointer-events-none absolute top-3 right-2 text-gray-400"})]})]})]}),us=({activeArchiveTab:l,setActiveArchiveTab:d})=>{const a=n=>{switch(n){case"official":return{icon:e.jsx(Ae,{className:"text-red-600"}),title:"Official Senior Archive",description:"Verified content from seniors",count:"15 resources"};case"seniors":return{icon:e.jsx(re,{className:"text-green-600"}),title:"Seniors' Personal Files",description:"Informal sharing from seniors",count:"28 resources"};case"classmates":return{icon:e.jsx(Le,{className:"text-blue-600"}),title:"Classmates' Personal Files",description:"Peer-to-peer sharing",count:"12 resources"};default:return{icon:null,title:"",description:"",count:""}}};return e.jsx("div",{className:"flex justify-between rounded-lg border border-gray-200 bg-white",children:["official","seniors","classmates"].map(n=>{const x=a(n);return e.jsx("button",{onClick:()=>d(n),className:`rounded-lg border cursor-pointer px-3 py-4 transition-colors ${l===n?"border-blue-600 bg-blue-50":"border-transparent hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[x.icon,e.jsx("h3",{className:`font-medium ${l===n?"text-blue-900":"text-gray-900"}`,children:x.title})]})},n)})})},ee=({file:l,onDownload:d,onRename:a,onDelete:n,onDetails:x})=>{const[i,r]=h.useState(!1),b=h.useRef(null);h.useEffect(()=>{const m=p=>{b.current&&!b.current.contains(p.target)&&r(!1)};return i&&document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[i]);const u=m=>{m(),r(!1)},g=[{icon:M,label:"Download",action:d,color:"text-blue-600",show:l.type==="file"},{icon:te,label:"Rename",action:a,color:"text-gray-700",show:!0},{icon:Ue,label:"Details",action:x,color:"text-gray-700",show:!0},{icon:ae,label:"Delete",action:n,color:"text-red-600",show:!0}].filter(m=>m.show);return e.jsxs("div",{ref:b,className:"relative",children:[e.jsx("button",{onClick:m=>{m.stopPropagation(),r(!i)},className:"rounded-lg p-2 text-gray-600 transition-colors hover:bg-gray-200",title:"More actions",children:e.jsx(se,{className:"h-4 w-4"})}),i&&e.jsx("div",{className:"absolute top-full right-0 z-50 mt-1 w-48 rounded-lg border border-gray-200 bg-white shadow-lg",children:e.jsx("div",{className:"py-1",children:g.map((m,p)=>e.jsxs("button",{onClick:y=>{y.stopPropagation(),u(m.action)},className:`flex w-full items-center gap-3 px-4 py-2 text-left text-sm transition-colors hover:bg-gray-50 ${m.color}`,children:[e.jsx(m.icon,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:m.label})]},p))})})]})},gs=({isOpen:l,onClose:d,file:a})=>{if(!l||!a)return null;const x=(u=>u.split(".").pop()?.toLowerCase()||"")(a.name),i=()=>{switch(x){case"pdf":return e.jsx(ze,{className:"h-16 w-16 text-red-500"});case"doc":case"docx":return e.jsx(Be,{className:"h-16 w-16 text-blue-500"});case"xls":case"xlsx":return e.jsx(Me,{className:"h-16 w-16 text-green-500"});case"ppt":case"pptx":return e.jsx(Ee,{className:"h-16 w-16 text-orange-500"});default:return e.jsx(E,{className:"h-16 w-16 text-gray-500"})}},r=["pdf","jpg","jpeg","png","gif","webp","svg"].includes(x),b=()=>{const u=document.createElement("a");u.href=a.url||"#",u.download=a.name,u.click()};return e.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-center justify-center bg-black p-4",children:e.jsxs("div",{className:"relative max-h-[90vh] w-full max-w-4xl overflow-hidden rounded-lg bg-white shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 bg-gray-50 p-4",children:[e.jsxs("div",{className:"flex-1 pr-4",children:[e.jsx("h3",{className:"truncate text-lg font-semibold text-gray-900",children:a.name}),e.jsxs("div",{className:"mt-1 flex items-center gap-4 text-sm text-gray-600",children:[a.size&&e.jsx("span",{children:a.size}),a.uploadedBy&&e.jsxs("span",{children:["Uploaded by ",a.uploadedBy]}),a.uploadDate&&e.jsx("span",{children:a.uploadDate})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:b,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-blue-700",children:[e.jsx(M,{className:"h-4 w-4"}),"Download"]}),e.jsx("button",{onClick:d,className:"rounded-lg p-2 text-gray-600 transition-colors hover:bg-gray-200",children:e.jsx(H,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"overflow-auto",style:{maxHeight:"calc(90vh - 80px)"},children:r?e.jsx("div",{className:"p-4",children:["jpg","jpeg","png","gif","webp","svg"].includes(x)?e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:a.url||"/placeholder-image.jpg",alt:a.name,className:"max-h-[70vh] max-w-full rounded-lg object-contain"})}):x==="pdf"?e.jsx("div",{className:"h-[70vh]",children:e.jsx("iframe",{src:a.url||"",className:"h-full w-full rounded-lg border border-gray-300",title:a.name})}):null}):e.jsxs("div",{className:"flex flex-col items-center justify-center p-12",children:[i(),e.jsx("p",{className:"mt-4 text-lg font-medium text-gray-900",children:a.name}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Preview not available for this file type"}),e.jsxs("button",{onClick:b,className:"mt-6 flex items-center gap-2 rounded-lg bg-blue-600 px-6 py-3 text-sm font-medium text-white transition-colors hover:bg-blue-700",children:[e.jsx(M,{className:"h-4 w-4"}),"Download to view"]})]})})]})})},ps=({isOpen:l,onClose:d,file:a})=>{if(!l||!a)return null;const n=[{icon:a.type==="file"?B:I,label:"Type",value:a.type==="file"?"File":"Folder"},{icon:E,label:"Name",value:a.name},...a.size?[{icon:E,label:"Size",value:a.size}]:[],...a.uploadedBy?[{icon:Oe,label:"Uploaded By",value:a.uploadedBy}]:[],...a.uploadDate?[{icon:Re,label:"Upload Date",value:a.uploadDate}]:[],...a.fileCount!==void 0&&a.type==="folder"?[{icon:B,label:"Files",value:`${a.fileCount} file(s)`}]:[],...a.downloads!==void 0?[{icon:E,label:"Downloads",value:`${a.downloads} download(s)`}]:[],...a.views!==void 0?[{icon:E,label:"Views",value:`${a.views} view(s)`}]:[]];return e.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-center justify-center bg-black p-4",children:e.jsxs("div",{className:"w-full max-w-md rounded-lg bg-white shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 bg-gray-50 p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[a.type==="file"?"File":"Folder"," Details"]}),e.jsx("button",{onClick:d,className:"rounded-lg p-2 text-gray-600 transition-colors hover:bg-gray-200",children:e.jsx(H,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[n.map((x,i)=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5 rounded-lg bg-blue-50 p-2 text-blue-600",children:e.jsx(x.icon,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:x.label}),e.jsx("p",{className:"mt-1 text-sm break-words text-gray-900",children:x.value})]})]},i)),a.description&&e.jsxs("div",{className:"mt-4 rounded-lg bg-gray-50 p-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Description"}),e.jsx("p",{className:"mt-2 text-sm text-gray-700",children:a.description})]})]})}),e.jsx("div",{className:"border-t border-gray-200 bg-gray-50 p-4",children:e.jsx("button",{onClick:d,className:"w-full rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-blue-700",children:"Close"})})]})})},bs=()=>{const l=R(),d=w(Ge),a=w(Qe),n=w(He),x=w(Ve),i=w(Xe),r=x.length>0?x[x.length-1].id:null,[b,u]=h.useState(new Set),[g,m]=h.useState(!1),[p,y]=h.useState(null),[F,S]=h.useState(!1),[s,o]=h.useState(!1),D=t=>{u(j=>{const v=new Set(j);return v.has(t)?v.delete(t):v.add(t),v})},c=(t,j,v,xe)=>{l(_e({courseId:t,courseName:j,folderId:v,folderName:xe}))},k=()=>{l(We())},T=t=>{l(Ke(t))},f=(t,j)=>{l(Je({id:t,name:j}))},C=async()=>{const t=await ie();t&&r&&(l(Ze({parentFolderId:r,folderName:t})),P({title:"Folder created",text:`"${t}" has been created successfully`}))},$=()=>{m(!0)},N=t=>{y(t),S(!0)},de=t=>{const j=document.createElement("a");j.href=t.url||"#",j.download=t.name,j.click(),P({title:"Download started",text:`Downloading ${t.name}`})},V=async t=>{const j=await ne(t.name);j&&j!==t.name&&P({title:"Renamed",text:`File renamed to "${j}"`})},X=async t=>{await oe(t.name)&&P({title:"Deleted",text:"File deleted successfully"})},W=t=>{y(t),o(!0)},K=t=>{if(!r)return;const j=t.map(v=>({name:v.name,size:`${(v.size/1024).toFixed(1)} KB`}));l(Ye({folderId:r,files:j})),cs(t.length)},z=i.filter(t=>t.type==="folder"),G=i.filter(t=>t.type==="file");return n?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[x.length>1&&e.jsxs("button",{onClick:k,className:"flex h-[38px] items-center space-x-2 rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 transition-colors hover:bg-gray-50",children:[e.jsx(le,{className:"h-4 w-4"}),e.jsx("span",{children:"Back"})]}),e.jsx(ce,{currentPath:x,onNavigate:T})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 bg-gray-50 p-3",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900",children:["Folders (",z.length,")"]}),e.jsx(U,{icon:A,label:"New Folder",onClick:C})]}),z.length>0&&e.jsx("div",{className:"divide-y divide-gray-100",children:z.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 transition-colors hover:bg-gray-50",children:[e.jsxs("div",{onClick:()=>f(t.id,t.name),className:"flex flex-1 cursor-pointer items-center space-x-3",children:[e.jsx(I,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"truncate text-sm font-medium text-gray-900",children:t.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[t.fileCount||0," files"]})]}),e.jsx(L,{className:"h-4 w-4 text-gray-400"})]}),e.jsx(ee,{file:t,onDownload:()=>{},onRename:()=>V(t),onDelete:()=>X(t),onDetails:()=>W(t)})]},t.id))}),z.length===0&&e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"No folders yet. Create a new folder to get started."})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 bg-gray-50 p-3",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900",children:["Files (",G.length,")"]}),e.jsx(U,{icon:A,label:"Upload File",onClick:$})]}),G.length>0?e.jsx("div",{className:"divide-y divide-gray-100",children:G.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 transition-colors hover:bg-gray-50",children:[e.jsxs("div",{onClick:()=>N(t),className:"flex flex-1 cursor-pointer items-center space-x-3",children:[e.jsx(B,{className:"h-5 w-5 text-red-500"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"truncate text-sm font-medium text-gray-900",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx("span",{children:t.size||"Unknown size"}),t.uploadedBy&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx("span",{children:t.uploadedBy})]})]})]})]}),e.jsx(ee,{file:t,onDownload:()=>de(t),onRename:()=>V(t),onDelete:()=>X(t),onDetails:()=>W(t)})]},t.id))}):e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"No files yet. Upload files to get started."})]})]}),e.jsx(Q,{isOpen:g,onClose:()=>m(!1),onUploadFiles:K})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"mb-3 text-sm font-semibold text-gray-700",children:["Theory Courses (",d.length,")"]}),d.length>0?e.jsx("div",{className:"grid items-start gap-4 md:grid-cols-2",children:d.map(t=>{const j=b.has(t.id);return e.jsxs("div",{className:"overflow-hidden rounded-lg border border-gray-200 bg-white",children:[e.jsxs("div",{onClick:()=>D(t.id),className:"flex cursor-pointer items-center justify-between border-b border-gray-100 bg-gray-50 p-3 transition-colors hover:bg-gray-100",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-900",children:[t.name," (",t.code,")"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[t.fileCount," total files"]})]}),e.jsx("div",{className:"ml-2",children:j?e.jsx(O,{className:"h-4 w-4 text-gray-500"}):e.jsx(L,{className:"h-4 w-4 text-gray-500"})})]}),j&&e.jsx("div",{className:"divide-y divide-gray-100",children:t.folders.map(v=>e.jsx("div",{onClick:()=>c(t.id,t.name,v.id,v.name),className:"group flex cursor-pointer items-center justify-between p-3 transition-colors hover:bg-gray-50",children:e.jsxs("div",{className:"flex flex-1 items-center space-x-3",children:[e.jsx("div",{className:"text-lg",children:e.jsx(I,{className:"text-blue-500"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"truncate text-sm font-medium text-gray-900",children:v.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[v.fileCount," files"]})]})]})},v.id))})]},t.id)})}):e.jsx("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4 text-center",children:e.jsx("p",{className:"text-sm text-gray-500",children:"No theory courses found for this level and term"})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"mb-3 text-sm font-semibold text-gray-700",children:["Sessional Courses (",a.length,")"]}),a.length>0?e.jsx("div",{className:"grid items-start gap-4 md:grid-cols-2",children:a.map(t=>{const j=b.has(t.id);return e.jsxs("div",{className:"overflow-hidden rounded-lg border border-gray-200 bg-white",children:[e.jsxs("div",{onClick:()=>D(t.id),className:"flex cursor-pointer items-center justify-between border-b border-gray-100 bg-gray-50 p-3 transition-colors hover:bg-gray-100",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-900",children:[t.name," (",t.code,")"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[t.fileCount," total files"]})]}),e.jsx("div",{className:"ml-2",children:j?e.jsx(O,{className:"h-4 w-4 text-gray-500"}):e.jsx(L,{className:"h-4 w-4 text-gray-500"})})]}),j&&e.jsx("div",{className:"divide-y divide-gray-100",children:t.folders.map(v=>e.jsx("div",{onClick:()=>c(t.id,t.name,v.id,v.name),className:"group flex cursor-pointer items-center justify-between p-3 transition-colors hover:bg-gray-50",children:e.jsxs("div",{className:"flex flex-1 items-center space-x-3",children:[e.jsx("div",{className:"text-lg",children:e.jsx(I,{className:"text-green-500"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"truncate text-sm font-medium text-gray-900",children:v.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[v.fileCount," files"]})]})]})},v.id))})]},t.id)})}):e.jsx("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4 text-center",children:e.jsx("p",{className:"text-sm text-gray-500",children:"No sessional courses found for this level and term"})})]})]}),e.jsx(Q,{isOpen:g,onClose:()=>m(!1),onUploadFiles:K}),e.jsx(gs,{isOpen:F,onClose:()=>S(!1),file:p}),e.jsx(ps,{isOpen:s,onClose:()=>o(!1),file:p})]})};function fs(){const l=R(),d=w(qe),a=w(es),n=w(ss),x=w(ts),i=w(as),r=w(ls),b=p=>l(rs(p)),u=p=>l(ns(p)),g=p=>l(os(p)),m=p=>l(is(p));return e.jsxs("div",{className:"space-y-3",children:[e.jsx(hs,{selectedLevel:d,setSelectedLevel:b,selectedTerm:a,setSelectedTerm:u,searchQuery:x,setSearchQuery:m,levels:i,terms:r}),e.jsx(us,{activeArchiveTab:n,setActiveArchiveTab:g}),e.jsx(bs,{})]})}const ys=()=>{const[l,d]=h.useState("personal"),a=[{id:"personal",label:"My Personal Files",Icon:I},{id:"community",label:"Community Study Archive",Icon:re}];return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-evenly rounded-2xl border border-gray-300 bg-gray-50",children:a.map(n=>e.jsxs("button",{onClick:()=>d(n.id),className:`flex items-center gap-2 border-b-3 px-5 py-3 text-sm font-medium transition-colors ${l===n.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:border-gray-500 hover:text-gray-700"}`,children:[e.jsx(n.Icon,{className:"text-lg"}),n.label]},n.id))}),e.jsxs("div",{className:"w-full",children:[l==="personal"&&e.jsx(ms,{}),l==="community"&&e.jsx(fs,{})]})]})};export{ys as default};
