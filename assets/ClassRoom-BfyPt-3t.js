import{j as e,U as Ks,au as Ys,H as Gs,N as Zs,av as Q,ai as Js,c as Z,W as De,aw as Ns,ax as ae,ay as Xs,az as ne,b as ye,aA as Qs,aB as et,r as L,aC as st,aD as tt,aE as rt,aF as ke,aG as Re,aH as Te,aI as ws,aJ as Cs,aK as ks,aL as Ue,aM as As,aN as it,aO as at,aP as nt,aQ as Ss,aR as Fs,u as lt,aS as ot,aT as dt,aU as ct,aV as ut,aW as mt,y as as,aX as xt,aY as ft,aZ as ht,o as gt,a_ as bt,a$ as yt,b0 as vt,b1 as pt,b2 as jt,b3 as Nt,b4 as wt,b5 as Ct,b6 as Rs,b7 as kt,b8 as At,b9 as St,ba as ns,m as Ne,bb as Ft,bc as Rt,R as Et,z as pe,bd as _t,be as Dt,bf as Tt}from"./index-C3Mgf05E.js";import{s as Es,a as It,b as Vt}from"./customModals-BC83HNnZ.js";import{F as Mt}from"./FriendCard-C8PPmW9H.js";import{s as ls,c as $e}from"./sweetAlert-CYyJlmlj.js";const Lt=({onOpenCreate:s,showCreate:r=!0})=>e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"ClassRoom"}),e.jsx("p",{className:"text-gray-600",children:"Join and manage your online classes."})]}),e.jsx("div",{children:r&&e.jsxs("button",{onClick:()=>s?.(),className:"flex items-center gap-2 rounded-lg border-2 border-dashed border-blue-300 bg-blue-50 px-4 py-2 text-sm font-semibold text-blue-600 transition-colors hover:border-blue-400 hover:bg-blue-100",children:[e.jsx(Ks,{className:"h-4 w-4"}),"Create Room"]})})]}),Ot=[{id:"classroom",label:"Rooms",to:"/classroom",icon:Ys},{id:"more",label:"More",to:"/classroom/more",icon:Gs}],Pt=()=>e.jsx("div",{className:"rounded-md border border-gray-200 bg-white p-2 shadow-sm",children:e.jsx("nav",{className:"flex justify-between overflow-x-auto",children:Ot.map(s=>{const r=s.icon;return e.jsxs(Zs,{to:s.to,end:s.id==="classroom",className:({isActive:t})=>`flex items-center gap-2 rounded-md px-3 py-2 text-sm font-medium transition-colors focus:outline-none ${t?"bg-blue-600 text-white shadow":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(r,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden md:inline",children:s.label})]},s.id)})})});var Ae=s=>s.type==="checkbox",fe=s=>s instanceof Date,te=s=>s==null;const _s=s=>typeof s=="object";var G=s=>!te(s)&&!Array.isArray(s)&&_s(s)&&!fe(s),Bt=s=>G(s)&&s.target?Ae(s.target)?s.target.checked:s.target.value:s,Ut=s=>s.substring(0,s.search(/\.\d+(\.|$)/))||s,$t=(s,r)=>s.has(Ut(r)),qt=s=>{const r=s.constructor&&s.constructor.prototype;return G(r)&&r.hasOwnProperty("isPrototypeOf")},He=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function J(s){let r;const t=Array.isArray(s),a=typeof FileList<"u"?s instanceof FileList:!1;if(s instanceof Date)r=new Date(s);else if(!(He&&(s instanceof Blob||a))&&(t||G(s)))if(r=t?[]:Object.create(Object.getPrototypeOf(s)),!t&&!qt(s))r=s;else for(const d in s)s.hasOwnProperty(d)&&(r[d]=J(s[d]));else return s;return r}var Ie=s=>/^\w*$/.test(s),K=s=>s===void 0,We=s=>Array.isArray(s)?s.filter(Boolean):[],Ke=s=>We(s.replace(/["|']|\]/g,"").split(/\.|\[/)),R=(s,r,t)=>{if(!r||!G(s))return t;const a=(Ie(r)?[r]:Ke(r)).reduce((d,n)=>te(d)?d:d[n],s);return K(a)||a===s?K(s[r])?t:s[r]:a},de=s=>typeof s=="boolean",H=(s,r,t)=>{let a=-1;const d=Ie(r)?[r]:Ke(r),n=d.length,m=n-1;for(;++a<n;){const c=d[a];let _=t;if(a!==m){const k=s[c];_=G(k)||Array.isArray(k)?k:isNaN(+d[a+1])?{}:[]}if(c==="__proto__"||c==="constructor"||c==="prototype")return;s[c]=_,s=s[c]}};const os={BLUR:"blur",FOCUS_OUT:"focusout"},le={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},ce={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},zt=Q.createContext(null);zt.displayName="HookFormContext";var Ht=(s,r,t,a=!0)=>{const d={defaultValues:r._defaultValues};for(const n in s)Object.defineProperty(d,n,{get:()=>{const m=n;return r._proxyFormState[m]!==le.all&&(r._proxyFormState[m]=!a||le.all),s[m]}});return d};const Wt=typeof window<"u"?Q.useLayoutEffect:Q.useEffect;var re=s=>typeof s=="string",Kt=(s,r,t,a,d)=>re(s)?(a&&r.watch.add(s),R(t,s,d)):Array.isArray(s)?s.map(n=>(a&&r.watch.add(n),R(t,n))):(a&&(r.watchAll=!0),t),qe=s=>te(s)||!_s(s);function xe(s,r,t=new WeakSet){if(qe(s)||qe(r))return s===r;if(fe(s)&&fe(r))return s.getTime()===r.getTime();const a=Object.keys(s),d=Object.keys(r);if(a.length!==d.length)return!1;if(t.has(s)||t.has(r))return!0;t.add(s),t.add(r);for(const n of a){const m=s[n];if(!d.includes(n))return!1;if(n!=="ref"){const c=r[n];if(fe(m)&&fe(c)||G(m)&&G(c)||Array.isArray(m)&&Array.isArray(c)?!xe(m,c,t):m!==c)return!1}}return!0}var Yt=(s,r,t,a,d)=>r?{...t[s],types:{...t[s]&&t[s].types?t[s].types:{},[a]:d||!0}}:{},we=s=>Array.isArray(s)?s:[s],ds=()=>{let s=[];return{get observers(){return s},next:d=>{for(const n of s)n.next&&n.next(d)},subscribe:d=>(s.push(d),{unsubscribe:()=>{s=s.filter(n=>n!==d)}}),unsubscribe:()=>{s=[]}}};function Ds(s,r){const t={};for(const a in s)if(s.hasOwnProperty(a)){const d=s[a],n=r[a];if(d&&G(d)&&n){const m=Ds(d,n);G(m)&&(t[a]=m)}else s[a]&&(t[a]=n)}return t}var se=s=>G(s)&&!Object.keys(s).length,Ye=s=>s.type==="file",oe=s=>typeof s=="function",Ee=s=>{if(!He)return!1;const r=s?s.ownerDocument:0;return s instanceof(r&&r.defaultView?r.defaultView.HTMLElement:HTMLElement)},Ts=s=>s.type==="select-multiple",Ge=s=>s.type==="radio",Gt=s=>Ge(s)||Ae(s),Be=s=>Ee(s)&&s.isConnected;function Zt(s,r){const t=r.slice(0,-1).length;let a=0;for(;a<t;)s=K(s)?a++:s[r[a++]];return s}function Jt(s){for(const r in s)if(s.hasOwnProperty(r)&&!K(s[r]))return!1;return!0}function Y(s,r){const t=Array.isArray(r)?r:Ie(r)?[r]:Ke(r),a=t.length===1?s:Zt(s,t),d=t.length-1,n=t[d];return a&&delete a[n],d!==0&&(G(a)&&se(a)||Array.isArray(a)&&Jt(a))&&Y(s,t.slice(0,-1)),s}var Xt=s=>{for(const r in s)if(oe(s[r]))return!0;return!1};function Is(s){return Array.isArray(s)||G(s)&&!Xt(s)}function ze(s,r={}){for(const t in s)Is(s[t])?(r[t]=Array.isArray(s[t])?[]:{},ze(s[t],r[t])):K(s[t])||(r[t]=!0);return r}function be(s,r,t){t||(t=ze(r));for(const a in s)Is(s[a])?K(r)||qe(t[a])?t[a]=ze(s[a],Array.isArray(s[a])?[]:{}):be(s[a],te(r)?{}:r[a],t[a]):t[a]=!xe(s[a],r[a]);return t}const cs={value:!1,isValid:!1},us={value:!0,isValid:!0};var Vs=s=>{if(Array.isArray(s)){if(s.length>1){const r=s.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:r,isValid:!!r.length}}return s[0].checked&&!s[0].disabled?s[0].attributes&&!K(s[0].attributes.value)?K(s[0].value)||s[0].value===""?us:{value:s[0].value,isValid:!0}:us:cs}return cs},Ms=(s,{valueAsNumber:r,valueAsDate:t,setValueAs:a})=>K(s)?s:r?s===""?NaN:s&&+s:t&&re(s)?new Date(s):a?a(s):s;const ms={isValid:!1,value:null};var Ls=s=>Array.isArray(s)?s.reduce((r,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:r,ms):ms;function xs(s){const r=s.ref;return Ye(r)?r.files:Ge(r)?Ls(s.refs).value:Ts(r)?[...r.selectedOptions].map(({value:t})=>t):Ae(r)?Vs(s.refs).value:Ms(K(r.value)?s.ref.value:r.value,s)}var Qt=(s,r,t,a)=>{const d={};for(const n of s){const m=R(r,n);m&&H(d,n,m._f)}return{criteriaMode:t,names:[...s],fields:d,shouldUseNativeValidation:a}},_e=s=>s instanceof RegExp,je=s=>K(s)?s:_e(s)?s.source:G(s)?_e(s.value)?s.value.source:s.value:s,fs=s=>({isOnSubmit:!s||s===le.onSubmit,isOnBlur:s===le.onBlur,isOnChange:s===le.onChange,isOnAll:s===le.all,isOnTouch:s===le.onTouched});const hs="AsyncFunction";var er=s=>!!s&&!!s.validate&&!!(oe(s.validate)&&s.validate.constructor.name===hs||G(s.validate)&&Object.values(s.validate).find(r=>r.constructor.name===hs)),sr=s=>s.mount&&(s.required||s.min||s.max||s.maxLength||s.minLength||s.pattern||s.validate),gs=(s,r,t)=>!t&&(r.watchAll||r.watch.has(s)||[...r.watch].some(a=>s.startsWith(a)&&/^\.\w+/.test(s.slice(a.length))));const Ce=(s,r,t,a)=>{for(const d of t||Object.keys(s)){const n=R(s,d);if(n){const{_f:m,...c}=n;if(m){if(m.refs&&m.refs[0]&&r(m.refs[0],d)&&!a)return!0;if(m.ref&&r(m.ref,m.name)&&!a)return!0;if(Ce(c,r))break}else if(G(c)&&Ce(c,r))break}}};function bs(s,r,t){const a=R(s,t);if(a||Ie(t))return{error:a,name:t};const d=t.split(".");for(;d.length;){const n=d.join("."),m=R(r,n),c=R(s,n);if(m&&!Array.isArray(m)&&t!==n)return{name:t};if(c&&c.type)return{name:n,error:c};if(c&&c.root&&c.root.type)return{name:`${n}.root`,error:c.root};d.pop()}return{name:t}}var tr=(s,r,t,a)=>{t(s);const{name:d,...n}=s;return se(n)||Object.keys(n).length>=Object.keys(r).length||Object.keys(n).find(m=>r[m]===(!a||le.all))},rr=(s,r,t)=>!s||!r||s===r||we(s).some(a=>a&&(t?a===r:a.startsWith(r)||r.startsWith(a))),ir=(s,r,t,a,d)=>d.isOnAll?!1:!t&&d.isOnTouch?!(r||s):(t?a.isOnBlur:d.isOnBlur)?!s:(t?a.isOnChange:d.isOnChange)?s:!0,ar=(s,r)=>!We(R(s,r)).length&&Y(s,r),nr=(s,r,t)=>{const a=we(R(s,t));return H(a,"root",r[t]),H(s,t,a),s};function ys(s,r,t="validate"){if(re(s)||Array.isArray(s)&&s.every(re)||de(s)&&!s)return{type:t,message:re(s)?s:"",ref:r}}var ge=s=>G(s)&&!_e(s)?s:{value:s,message:""},vs=async(s,r,t,a,d,n)=>{const{ref:m,refs:c,required:_,maxLength:k,minLength:f,min:C,max:x,pattern:w,validate:S,name:h,valueAsNumber:y,mount:V}=s._f,p=R(t,h);if(!V||r.has(h))return{};const T=c?c[0]:m,O=v=>{d&&T.reportValidity&&(T.setCustomValidity(de(v)?"":v||""),T.reportValidity())},I={},z=Ge(m),M=Ae(m),X=z||M,W=(y||Ye(m))&&K(m.value)&&K(p)||Ee(m)&&m.value===""||p===""||Array.isArray(p)&&!p.length,l=Yt.bind(null,h,a,I),D=(v,F,A,B=ce.maxLength,j=ce.minLength)=>{const U=v?F:A;I[h]={type:v?B:j,message:U,ref:m,...l(v?B:j,U)}};if(n?!Array.isArray(p)||!p.length:_&&(!X&&(W||te(p))||de(p)&&!p||M&&!Vs(c).isValid||z&&!Ls(c).isValid)){const{value:v,message:F}=re(_)?{value:!!_,message:_}:ge(_);if(v&&(I[h]={type:ce.required,message:F,ref:T,...l(ce.required,F)},!a))return O(F),I}if(!W&&(!te(C)||!te(x))){let v,F;const A=ge(x),B=ge(C);if(!te(p)&&!isNaN(p)){const j=m.valueAsNumber||p&&+p;te(A.value)||(v=j>A.value),te(B.value)||(F=j<B.value)}else{const j=m.valueAsDate||new Date(p),U=ue=>new Date(new Date().toDateString()+" "+ue),q=m.type=="time",ee=m.type=="week";re(A.value)&&p&&(v=q?U(p)>U(A.value):ee?p>A.value:j>new Date(A.value)),re(B.value)&&p&&(F=q?U(p)<U(B.value):ee?p<B.value:j<new Date(B.value))}if((v||F)&&(D(!!v,A.message,B.message,ce.max,ce.min),!a))return O(I[h].message),I}if((k||f)&&!W&&(re(p)||n&&Array.isArray(p))){const v=ge(k),F=ge(f),A=!te(v.value)&&p.length>+v.value,B=!te(F.value)&&p.length<+F.value;if((A||B)&&(D(A,v.message,F.message),!a))return O(I[h].message),I}if(w&&!W&&re(p)){const{value:v,message:F}=ge(w);if(_e(v)&&!p.match(v)&&(I[h]={type:ce.pattern,message:F,ref:m,...l(ce.pattern,F)},!a))return O(F),I}if(S){if(oe(S)){const v=await S(p,t),F=ys(v,T);if(F&&(I[h]={...F,...l(ce.validate,F.message)},!a))return O(F.message),I}else if(G(S)){let v={};for(const F in S){if(!se(v)&&!a)break;const A=ys(await S[F](p,t),T,F);A&&(v={...A,...l(F,A.message)},O(A.message),a&&(I[h]=v))}if(!se(v)&&(I[h]={ref:T,...v},!a))return I}}return O(!0),I};const lr={mode:le.onSubmit,reValidateMode:le.onChange,shouldFocusError:!0};function or(s={}){let r={...lr,...s},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:oe(r.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1},a={},d=G(r.defaultValues)||G(r.values)?J(r.defaultValues||r.values)||{}:{},n=r.shouldUnregister?{}:J(d),m={action:!1,mount:!1,watch:!1},c={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},_,k=0;const f={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let C={...f};const x={array:ds(),state:ds()},w=r.criteriaMode===le.all,S=i=>o=>{clearTimeout(k),k=setTimeout(i,o)},h=async i=>{if(!r.disabled&&(f.isValid||C.isValid||i)){const o=r.resolver?se((await M()).errors):await W(a,!0);o!==t.isValid&&x.state.next({isValid:o})}},y=(i,o)=>{!r.disabled&&(f.isValidating||f.validatingFields||C.isValidating||C.validatingFields)&&((i||Array.from(c.mount)).forEach(u=>{u&&(o?H(t.validatingFields,u,o):Y(t.validatingFields,u))}),x.state.next({validatingFields:t.validatingFields,isValidating:!se(t.validatingFields)}))},V=(i,o=[],u,N,b=!0,g=!0)=>{if(N&&u&&!r.disabled){if(m.action=!0,g&&Array.isArray(R(a,i))){const E=u(R(a,i),N.argA,N.argB);b&&H(a,i,E)}if(g&&Array.isArray(R(t.errors,i))){const E=u(R(t.errors,i),N.argA,N.argB);b&&H(t.errors,i,E),ar(t.errors,i)}if((f.touchedFields||C.touchedFields)&&g&&Array.isArray(R(t.touchedFields,i))){const E=u(R(t.touchedFields,i),N.argA,N.argB);b&&H(t.touchedFields,i,E)}(f.dirtyFields||C.dirtyFields)&&(t.dirtyFields=be(d,n)),x.state.next({name:i,isDirty:D(i,o),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else H(n,i,o)},p=(i,o)=>{H(t.errors,i,o),x.state.next({errors:t.errors})},T=i=>{t.errors=i,x.state.next({errors:t.errors,isValid:!1})},O=(i,o,u,N)=>{const b=R(a,i);if(b){const g=R(n,i,K(u)?R(d,i):u);K(g)||N&&N.defaultChecked||o?H(n,i,o?g:xs(b._f)):A(i,g),m.mount&&h()}},I=(i,o,u,N,b)=>{let g=!1,E=!1;const P={name:i};if(!r.disabled){if(!u||N){(f.isDirty||C.isDirty)&&(E=t.isDirty,t.isDirty=P.isDirty=D(),g=E!==P.isDirty);const $=xe(R(d,i),o);E=!!R(t.dirtyFields,i),$?Y(t.dirtyFields,i):H(t.dirtyFields,i,!0),P.dirtyFields=t.dirtyFields,g=g||(f.dirtyFields||C.dirtyFields)&&E!==!$}if(u){const $=R(t.touchedFields,i);$||(H(t.touchedFields,i,u),P.touchedFields=t.touchedFields,g=g||(f.touchedFields||C.touchedFields)&&$!==u)}g&&b&&x.state.next(P)}return g?P:{}},z=(i,o,u,N)=>{const b=R(t.errors,i),g=(f.isValid||C.isValid)&&de(o)&&t.isValid!==o;if(r.delayError&&u?(_=S(()=>p(i,u)),_(r.delayError)):(clearTimeout(k),_=null,u?H(t.errors,i,u):Y(t.errors,i)),(u?!xe(b,u):b)||!se(N)||g){const E={...N,...g&&de(o)?{isValid:o}:{},errors:t.errors,name:i};t={...t,...E},x.state.next(E)}},M=async i=>{y(i,!0);const o=await r.resolver(n,r.context,Qt(i||c.mount,a,r.criteriaMode,r.shouldUseNativeValidation));return y(i),o},X=async i=>{const{errors:o}=await M(i);if(i)for(const u of i){const N=R(o,u);N?H(t.errors,u,N):Y(t.errors,u)}else t.errors=o;return o},W=async(i,o,u={valid:!0})=>{for(const N in i){const b=i[N];if(b){const{_f:g,...E}=b;if(g){const P=c.array.has(g.name),$=b._f&&er(b._f);$&&f.validatingFields&&y([g.name],!0);const ie=await vs(b,c.disabled,n,w,r.shouldUseNativeValidation&&!o,P);if($&&f.validatingFields&&y([g.name]),ie[g.name]&&(u.valid=!1,o))break;!o&&(R(ie,g.name)?P?nr(t.errors,ie,g.name):H(t.errors,g.name,ie[g.name]):Y(t.errors,g.name))}!se(E)&&await W(E,o,u)}}return u.valid},l=()=>{for(const i of c.unMount){const o=R(a,i);o&&(o._f.refs?o._f.refs.every(u=>!Be(u)):!Be(o._f.ref))&&Ve(i)}c.unMount=new Set},D=(i,o)=>!r.disabled&&(i&&o&&H(n,i,o),!xe(ue(),d)),v=(i,o,u)=>Kt(i,c,{...m.mount?n:K(o)?d:re(i)?{[i]:o}:o},u,o),F=i=>We(R(m.mount?n:d,i,r.shouldUnregister?R(d,i,[]):[])),A=(i,o,u={})=>{const N=R(a,i);let b=o;if(N){const g=N._f;g&&(!g.disabled&&H(n,i,Ms(o,g)),b=Ee(g.ref)&&te(o)?"":o,Ts(g.ref)?[...g.ref.options].forEach(E=>E.selected=b.includes(E.value)):g.refs?Ae(g.ref)?g.refs.forEach(E=>{(!E.defaultChecked||!E.disabled)&&(Array.isArray(b)?E.checked=!!b.find(P=>P===E.value):E.checked=b===E.value||!!b)}):g.refs.forEach(E=>E.checked=E.value===b):Ye(g.ref)?g.ref.value="":(g.ref.value=b,g.ref.type||x.state.next({name:i,values:J(n)})))}(u.shouldDirty||u.shouldTouch)&&I(i,b,u.shouldTouch,u.shouldDirty,!0),u.shouldValidate&&ee(i)},B=(i,o,u)=>{for(const N in o){if(!o.hasOwnProperty(N))return;const b=o[N],g=i+"."+N,E=R(a,g);(c.array.has(i)||G(b)||E&&!E._f)&&!fe(b)?B(g,b,u):A(g,b,u)}},j=(i,o,u={})=>{const N=R(a,i),b=c.array.has(i),g=J(o);H(n,i,g),b?(x.array.next({name:i,values:J(n)}),(f.isDirty||f.dirtyFields||C.isDirty||C.dirtyFields)&&u.shouldDirty&&x.state.next({name:i,dirtyFields:be(d,n),isDirty:D(i,g)})):N&&!N._f&&!te(g)?B(i,g,u):A(i,g,u),gs(i,c)&&x.state.next({...t,name:i}),x.state.next({name:m.mount?i:void 0,values:J(n)})},U=async i=>{m.mount=!0;const o=i.target;let u=o.name,N=!0;const b=R(a,u),g=$=>{N=Number.isNaN($)||fe($)&&isNaN($.getTime())||xe($,R(n,u,$))},E=fs(r.mode),P=fs(r.reValidateMode);if(b){let $,ie;const Se=o.type?xs(b._f):Bt(i),me=i.type===os.BLUR||i.type===os.FOCUS_OUT,zs=!sr(b._f)&&!r.resolver&&!R(t.errors,u)&&!b._f.deps||ir(me,R(t.touchedFields,u),t.isSubmitted,P,E),Oe=gs(u,c,me);H(n,u,Se),me?(!o||!o.readOnly)&&(b._f.onBlur&&b._f.onBlur(i),_&&_(0)):b._f.onChange&&b._f.onChange(i);const Pe=I(u,Se,me),Hs=!se(Pe)||Oe;if(!me&&x.state.next({name:u,type:i.type,values:J(n)}),zs)return(f.isValid||C.isValid)&&(r.mode==="onBlur"?me&&h():me||h()),Hs&&x.state.next({name:u,...Oe?{}:Pe});if(!me&&Oe&&x.state.next({...t}),r.resolver){const{errors:rs}=await M([u]);if(g(Se),N){const Ws=bs(t.errors,a,u),is=bs(rs,a,Ws.name||u);$=is.error,u=is.name,ie=se(rs)}}else y([u],!0),$=(await vs(b,c.disabled,n,w,r.shouldUseNativeValidation))[u],y([u]),g(Se),N&&($?ie=!1:(f.isValid||C.isValid)&&(ie=await W(a,!0)));N&&(b._f.deps&&(!Array.isArray(b._f.deps)||b._f.deps.length>0)&&ee(b._f.deps),z(u,ie,$,Pe))}},q=(i,o)=>{if(R(t.errors,o)&&i.focus)return i.focus(),1},ee=async(i,o={})=>{let u,N;const b=we(i);if(r.resolver){const g=await X(K(i)?i:b);u=se(g),N=i?!b.some(E=>R(g,E)):u}else i?(N=(await Promise.all(b.map(async g=>{const E=R(a,g);return await W(E&&E._f?{[g]:E}:E)}))).every(Boolean),!(!N&&!t.isValid)&&h()):N=u=await W(a);return x.state.next({...!re(i)||(f.isValid||C.isValid)&&u!==t.isValid?{}:{name:i},...r.resolver||!i?{isValid:u}:{},errors:t.errors}),o.shouldFocus&&!N&&Ce(a,q,i?b:c.mount),N},ue=(i,o)=>{let u={...m.mount?n:d};return o&&(u=Ds(o.dirtyFields?t.dirtyFields:t.touchedFields,u)),K(i)?u:re(i)?R(u,i):i.map(N=>R(u,N))},he=(i,o)=>({invalid:!!R((o||t).errors,i),isDirty:!!R((o||t).dirtyFields,i),error:R((o||t).errors,i),isValidating:!!R(t.validatingFields,i),isTouched:!!R((o||t).touchedFields,i)}),ve=i=>{i&&we(i).forEach(o=>Y(t.errors,o)),x.state.next({errors:i?t.errors:{}})},Ze=(i,o,u)=>{const N=(R(a,i,{_f:{}})._f||{}).ref,b=R(t.errors,i)||{},{ref:g,message:E,type:P,...$}=b;H(t.errors,i,{...$,...o,ref:N}),x.state.next({name:i,errors:t.errors,isValid:!1}),u&&u.shouldFocus&&N&&N.focus&&N.focus()},Os=(i,o)=>oe(i)?x.state.subscribe({next:u=>"values"in u&&i(v(void 0,o),u)}):v(i,o,!0),Je=i=>x.state.subscribe({next:o=>{rr(i.name,o.name,i.exact)&&tr(o,i.formState||f,qs,i.reRenderRoot)&&i.callback({values:{...n},...t,...o,defaultValues:d})}}).unsubscribe,Ps=i=>(m.mount=!0,C={...C,...i.formState},Je({...i,formState:C})),Ve=(i,o={})=>{for(const u of i?we(i):c.mount)c.mount.delete(u),c.array.delete(u),o.keepValue||(Y(a,u),Y(n,u)),!o.keepError&&Y(t.errors,u),!o.keepDirty&&Y(t.dirtyFields,u),!o.keepTouched&&Y(t.touchedFields,u),!o.keepIsValidating&&Y(t.validatingFields,u),!r.shouldUnregister&&!o.keepDefaultValue&&Y(d,u);x.state.next({values:J(n)}),x.state.next({...t,...o.keepDirty?{isDirty:D()}:{}}),!o.keepIsValid&&h()},Xe=({disabled:i,name:o})=>{(de(i)&&m.mount||i||c.disabled.has(o))&&(i?c.disabled.add(o):c.disabled.delete(o))},Me=(i,o={})=>{let u=R(a,i);const N=de(o.disabled)||de(r.disabled);return H(a,i,{...u||{},_f:{...u&&u._f?u._f:{ref:{name:i}},name:i,mount:!0,...o}}),c.mount.add(i),u?Xe({disabled:de(o.disabled)?o.disabled:r.disabled,name:i}):O(i,!0,o.value),{...N?{disabled:o.disabled||r.disabled}:{},...r.progressive?{required:!!o.required,min:je(o.min),max:je(o.max),minLength:je(o.minLength),maxLength:je(o.maxLength),pattern:je(o.pattern)}:{},name:i,onChange:U,onBlur:U,ref:b=>{if(b){Me(i,o),u=R(a,i);const g=K(b.value)&&b.querySelectorAll&&b.querySelectorAll("input,select,textarea")[0]||b,E=Gt(g),P=u._f.refs||[];if(E?P.find($=>$===g):g===u._f.ref)return;H(a,i,{_f:{...u._f,...E?{refs:[...P.filter(Be),g,...Array.isArray(R(d,i))?[{}]:[]],ref:{type:g.type,name:i}}:{ref:g}}}),O(i,!1,void 0,g)}else u=R(a,i,{}),u._f&&(u._f.mount=!1),(r.shouldUnregister||o.shouldUnregister)&&!($t(c.array,i)&&m.action)&&c.unMount.add(i)}}},Le=()=>r.shouldFocusError&&Ce(a,q,c.mount),Bs=i=>{de(i)&&(x.state.next({disabled:i}),Ce(a,(o,u)=>{const N=R(a,u);N&&(o.disabled=N._f.disabled||i,Array.isArray(N._f.refs)&&N._f.refs.forEach(b=>{b.disabled=N._f.disabled||i}))},0,!1))},Qe=(i,o)=>async u=>{let N;u&&(u.preventDefault&&u.preventDefault(),u.persist&&u.persist());let b=J(n);if(x.state.next({isSubmitting:!0}),r.resolver){const{errors:g,values:E}=await M();t.errors=g,b=J(E)}else await W(a);if(c.disabled.size)for(const g of c.disabled)Y(b,g);if(Y(t.errors,"root"),se(t.errors)){x.state.next({errors:{}});try{await i(b,u)}catch(g){N=g}}else o&&await o({...t.errors},u),Le(),setTimeout(Le);if(x.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:se(t.errors)&&!N,submitCount:t.submitCount+1,errors:t.errors}),N)throw N},Us=(i,o={})=>{R(a,i)&&(K(o.defaultValue)?j(i,J(R(d,i))):(j(i,o.defaultValue),H(d,i,J(o.defaultValue))),o.keepTouched||Y(t.touchedFields,i),o.keepDirty||(Y(t.dirtyFields,i),t.isDirty=o.defaultValue?D(i,J(R(d,i))):D()),o.keepError||(Y(t.errors,i),f.isValid&&h()),x.state.next({...t}))},es=(i,o={})=>{const u=i?J(i):d,N=J(u),b=se(i),g=b?d:N;if(o.keepDefaultValues||(d=u),!o.keepValues){if(o.keepDirtyValues){const E=new Set([...c.mount,...Object.keys(be(d,n))]);for(const P of Array.from(E))R(t.dirtyFields,P)?H(g,P,R(n,P)):j(P,R(g,P))}else{if(He&&K(i))for(const E of c.mount){const P=R(a,E);if(P&&P._f){const $=Array.isArray(P._f.refs)?P._f.refs[0]:P._f.ref;if(Ee($)){const ie=$.closest("form");if(ie){ie.reset();break}}}}if(o.keepFieldsRef)for(const E of c.mount)j(E,R(g,E));else a={}}n=r.shouldUnregister?o.keepDefaultValues?J(d):{}:J(g),x.array.next({values:{...g}}),x.state.next({values:{...g}})}c={mount:o.keepDirtyValues?c.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},m.mount=!f.isValid||!!o.keepIsValid||!!o.keepDirtyValues,m.watch=!!r.shouldUnregister,x.state.next({submitCount:o.keepSubmitCount?t.submitCount:0,isDirty:b?!1:o.keepDirty?t.isDirty:!!(o.keepDefaultValues&&!xe(i,d)),isSubmitted:o.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:b?{}:o.keepDirtyValues?o.keepDefaultValues&&n?be(d,n):t.dirtyFields:o.keepDefaultValues&&i?be(d,i):o.keepDirty?t.dirtyFields:{},touchedFields:o.keepTouched?t.touchedFields:{},errors:o.keepErrors?t.errors:{},isSubmitSuccessful:o.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:d})},ss=(i,o)=>es(oe(i)?i(n):i,o),$s=(i,o={})=>{const u=R(a,i),N=u&&u._f;if(N){const b=N.refs?N.refs[0]:N.ref;b.focus&&(b.focus(),o.shouldSelect&&oe(b.select)&&b.select())}},qs=i=>{t={...t,...i}},ts={control:{register:Me,unregister:Ve,getFieldState:he,handleSubmit:Qe,setError:Ze,_subscribe:Je,_runSchema:M,_focusError:Le,_getWatch:v,_getDirty:D,_setValid:h,_setFieldArray:V,_setDisabledField:Xe,_setErrors:T,_getFieldArray:F,_reset:es,_resetDefaultValues:()=>oe(r.defaultValues)&&r.defaultValues().then(i=>{ss(i,r.resetOptions),x.state.next({isLoading:!1})}),_removeUnmounted:l,_disableForm:Bs,_subjects:x,_proxyFormState:f,get _fields(){return a},get _formValues(){return n},get _state(){return m},set _state(i){m=i},get _defaultValues(){return d},get _names(){return c},set _names(i){c=i},get _formState(){return t},get _options(){return r},set _options(i){r={...r,...i}}},subscribe:Ps,trigger:ee,register:Me,handleSubmit:Qe,watch:Os,setValue:j,getValues:ue,reset:ss,resetField:Us,clearErrors:ve,unregister:Ve,setError:Ze,setFocus:$s,getFieldState:he};return{...ts,formControl:ts}}function dr(s={}){const r=Q.useRef(void 0),t=Q.useRef(void 0),[a,d]=Q.useState({isDirty:!1,isValidating:!1,isLoading:oe(s.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1,isReady:!1,defaultValues:oe(s.defaultValues)?void 0:s.defaultValues});if(!r.current)if(s.formControl)r.current={...s.formControl,formState:a},s.defaultValues&&!oe(s.defaultValues)&&s.formControl.reset(s.defaultValues,s.resetOptions);else{const{formControl:m,...c}=or(s);r.current={...c,formState:a}}const n=r.current.control;return n._options=s,Wt(()=>{const m=n._subscribe({formState:n._proxyFormState,callback:()=>d({...n._formState}),reRenderRoot:!0});return d(c=>({...c,isReady:!0})),n._formState.isReady=!0,m},[n]),Q.useEffect(()=>n._disableForm(s.disabled),[n,s.disabled]),Q.useEffect(()=>{s.mode&&(n._options.mode=s.mode),s.reValidateMode&&(n._options.reValidateMode=s.reValidateMode)},[n,s.mode,s.reValidateMode]),Q.useEffect(()=>{s.errors&&(n._setErrors(s.errors),n._focusError())},[n,s.errors]),Q.useEffect(()=>{s.shouldUnregister&&n._subjects.state.next({values:n._getWatch()})},[n,s.shouldUnregister]),Q.useEffect(()=>{if(n._proxyFormState.isDirty){const m=n._getDirty();m!==a.isDirty&&n._subjects.state.next({isDirty:m})}},[n,a.isDirty]),Q.useEffect(()=>{s.values&&!xe(s.values,t.current)?(n._reset(s.values,{keepFieldsRef:!0,...n._options.resetOptions}),t.current=s.values,d(m=>({...m}))):n._resetDefaultValues()},[n,s.values]),Q.useEffect(()=>{n._state.mount||(n._setValid(),n._state.mount=!0),n._state.watch&&(n._state.watch=!1,n._subjects.state.next({...n._formState})),n._removeUnmounted()}),r.current.formState=Ht(a,n),r.current}const cr=({onSubmit:s,onCancel:r})=>{const{register:t,handleSubmit:a,formState:d}=dr({defaultValues:{name:"",university:"",department:"",year:"",semester:"",section:"",subsection:""}}),{errors:n}=d,m=["BUET","DU","RUET","CUET","KUET"],c=["CSE","EEE","ME","CE","CHE"],_=["1","2","3","4","5"],k=["1","2"],f=["A","B","C"],C=["1","2"];return e.jsxs("form",{onSubmit:a(s),className:"w-full",children:[e.jsxs("div",{className:"mb-6 flex items-start gap-3",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 text-white shadow-lg",children:e.jsx(Js,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Create a New Study Room"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Set up a collaborative space for your class"})]})]}),e.jsxs("div",{className:"mb-5",children:[e.jsxs("label",{className:"mb-2 block text-sm font-semibold text-gray-700",children:["Room Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...t("name",{required:"Room name is required",minLength:{value:3,message:"Room name must be at least 3 characters"}}),placeholder:"e.g., CSE 2-1 Study Group",className:"block w-full rounded-lg border border-gray-300 bg-white px-4 py-3 text-gray-900 placeholder-gray-400 shadow-sm transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:outline-none"}),n.name?.message&&e.jsx("p",{className:"mt-1.5 text-sm text-red-600",children:n.name.message})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-semibold text-gray-700",children:["University ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{...t("university",{required:"University is required"}),className:"block w-full rounded-lg border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select university"}),m.map(x=>e.jsx("option",{value:x,children:x},x))]}),n.university?.message&&e.jsx("p",{className:"mt-1.5 text-sm text-red-600",children:n.university.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-semibold text-gray-700",children:["Department ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{...t("department",{required:"Department is required"}),className:"block w-full rounded-lg border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select department"}),c.map(x=>e.jsx("option",{value:x,children:x},x))]}),n.department?.message&&e.jsx("p",{className:"mt-1.5 text-sm text-red-600",children:n.department.message})]})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-semibold text-gray-700",children:["Year ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{...t("year",{required:"Year is required"}),className:"block w-full rounded-lg border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select year"}),_.map(x=>e.jsxs("option",{value:x,children:["Year ",x]},x))]}),n.year?.message&&e.jsx("p",{className:"mt-1.5 text-sm text-red-600",children:n.year.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-semibold text-gray-700",children:["Semester ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{...t("semester",{required:"Semester is required"}),className:"block w-full rounded-lg border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select semester"}),k.map(x=>e.jsxs("option",{value:x,children:["Semester ",x]},x))]}),n.semester?.message&&e.jsx("p",{className:"mt-1.5 text-sm text-red-600",children:n.semester.message})]})]}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-semibold text-gray-700",children:["Section ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{...t("section",{required:"Section is required"}),className:"block w-full rounded-lg border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select section"}),f.map(x=>e.jsxs("option",{value:x,children:["Section ",x]},x))]}),n.section?.message&&e.jsx("p",{className:"mt-1.5 text-sm text-red-600",children:n.section.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-semibold text-gray-700",children:"Subsection"}),e.jsxs("select",{...t("subsection"),className:"block w-full rounded-lg border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select subsection (optional)"}),C.map(x=>e.jsxs("option",{value:x,children:["Subsection ",x]},x))]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 border-t border-gray-200 pt-5",children:[e.jsx("button",{type:"button",onClick:r,className:"rounded-lg border border-gray-300 bg-white px-5 py-2.5 text-sm font-semibold text-gray-700 shadow-sm transition-colors hover:bg-gray-50 focus:ring-2 focus:ring-gray-300 focus:outline-none",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"inline-flex items-center gap-2 rounded-lg bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-2.5 text-sm font-semibold text-white shadow-lg transition-all hover:from-blue-700 hover:to-blue-800 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:outline-none",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})}),"Create Room"]})]})]})},ps=({room:s,menuOpenFor:r,toggleMenu:t,onToggleStatus:a})=>{const d=Z(w=>De(w,w.profile.id)),m=Z(w=>Ns(w,d?.id||"")).includes(s.id),k=Z(w=>w.classRoom.members).find(w=>w.roomId===s.id&&w.role==="creator")?.userId,f=s.coverImage||`https://picsum.photos/seed/${s.id}/400/225`,x=(w=>w?ne.find(h=>h.id===w)?.name:void 0)(k);return e.jsx("div",{className:"overflow-hidden rounded-lg shadow-sm",children:e.jsxs(ae,{to:`/classroom/rooms/${s.id}`,className:"relative block h-36 w-full bg-gray-100",children:[e.jsx("img",{src:f,alt:s.name,className:"h-full w-full object-cover"}),e.jsxs("div",{className:"absolute top-2 right-2 z-10",children:[e.jsx("button",{onClick:w=>t(w,s.id),"aria-label":"room options",className:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-black/40 text-white hover:bg-black/50",children:e.jsx(Xs,{className:"h-4 w-4"})}),r===s.id&&e.jsx("div",{onClick:w=>w.stopPropagation(),className:"absolute right-0 mt-2 w-40 rounded bg-white shadow-lg ring-1 ring-black/5",children:e.jsx("button",{className:"block w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50",onClick:w=>{w.preventDefault(),w.stopPropagation(),a(s.id)},children:m?"Unhide":"Hide"})})]}),e.jsxs("div",{className:"absolute top-0 left-0 w-full bg-black/70 p-2",children:[e.jsx("p",{className:"truncate text-sm font-medium text-white",children:s.name}),x&&e.jsx("p",{className:"mt-0.5 truncate text-xs text-gray-200",children:e.jsx(ae,{onClick:w=>w.stopPropagation(),to:`/profile/${k}`,className:"text-gray-200 hover:underline",children:x})})]})]})})},ur=({showCreateForm:s=!1,onCreate:r,onCancelCreate:t})=>{const a=ye(),n=Z(h=>De(h,h.profile.id))?.id||"",m=Z(h=>Qs(h)),c=Z(h=>et(h,n)),_=Z(h=>Ns(h,n)),k=m.filter(h=>c.includes(h.id)),f=m.filter(h=>_.includes(h.id)),[C,x]=L.useState(null);L.useEffect(()=>{x(null)},[k.length,f.length]),L.useEffect(()=>{const h=()=>x(null);return document.addEventListener("click",h),()=>document.removeEventListener("click",h)},[]);const w=(h,y)=>{h.preventDefault(),h.stopPropagation(),x(V=>V===y?null:y)},S=h=>{n&&(a(st({userId:n,roomId:h})),x(null))};return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Rooms"})}),s&&e.jsx("div",{className:"rounded-xl border border-gray-200 bg-white p-5 shadow",children:e.jsx("div",{children:e.jsx(cr,{onSubmit:h=>r?.(h),onCancel:t})})}),k.length+f.length===0?e.jsx("div",{className:"rounded-xl border border-gray-300 bg-white p-6 shadow",children:e.jsx("p",{className:"text-sm text-gray-600",children:"No rooms yet. Create one to get started."})}):e.jsx("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-3",children:k.map(h=>e.jsx(ps,{room:h,menuOpenFor:C,toggleMenu:w,onToggleStatus:S},h.id))}),f.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Hidden Rooms"}),e.jsx("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-3",children:f.map(h=>e.jsx(ps,{room:h,menuOpenFor:C,toggleMenu:w,onToggleStatus:S},h.id))})]})]})},mr=()=>e.jsxs("div",{className:"rounded-xl border border-gray-300 bg-white p-6 shadow",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"More"}),e.jsx("p",{className:"text-sm text-gray-600",children:"More tab placeholder content."})]});function xr(s){return tt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(s)}const fr=({roomId:s,currentUserId:r,onClose:t})=>{const[a,d]=L.useState(""),[n,m]=L.useState([]),c=L.useRef(null),_=ye(),k=()=>{const f=a.trim();if(!f&&n.length===0)return;const C=n.map(w=>({id:w.id,fileName:w.fileName,url:w.url,mimeType:w.mimeType,sizeKb:w.sizeKb})),x={id:`post-${Date.now()}`,roomId:s,authorId:r??"0",content:f,createdAt:new Date().toISOString(),replies:[],attachments:C.length?C:void 0};_(rt(x)),d(""),m([]),c.current&&(c.current.value=""),t?.()};return L.useEffect(()=>()=>{n.forEach(f=>{try{URL.revokeObjectURL(f.url)}catch{}})},[n]),e.jsxs("div",{className:"mx-auto max-w-5xl rounded-lg border border-gray-500 bg-white p-4 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Post"}),e.jsx("textarea",{className:"mt-2 w-full rounded border border-gray-200 p-2 text-sm",rows:4,value:a,onChange:f=>d(f.target.value),placeholder:"Write something to the room..."}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{ref:c,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:f=>{const C=Array.from(f.target.files||[]);if(C.length===0)return;const x=C.map(w=>({id:`att-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,fileName:w.name,url:URL.createObjectURL(w),mimeType:w.type,sizeKb:Math.round(w.size/1024),file:w}));m(w=>[...w,...x]),c.current&&(c.current.value="")}}),e.jsx("button",{onClick:()=>c.current?.click(),className:"rounded-md border border-gray-200 bg-white px-3 py-1 text-sm text-gray-700 hover:bg-gray-50",children:"Add Photos"}),n.length>0&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-sm text-gray-600",children:[n.length," photo",n.length>1?"s":""," ","selected"]})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{d(""),n.forEach(f=>{try{URL.revokeObjectURL(f.url)}catch{}}),m([]),t?.()},className:"rounded border border-gray-300 px-3 py-1 text-sm",children:"Cancel"}),e.jsx("button",{onClick:k,className:"rounded bg-blue-600 px-3 py-1 text-sm font-medium text-white disabled:opacity-50",disabled:a.trim()===""&&n.length===0,children:"Post"})]})]}),n.length>0&&e.jsx("div",{className:"mt-3 grid grid-cols-4 gap-2",children:n.map(f=>e.jsxs("div",{className:"relative overflow-hidden rounded border border-gray-200 bg-gray-50",children:[e.jsx("img",{src:f.url,alt:f.fileName,className:"h-24 w-full object-cover"}),e.jsx("button",{onClick:()=>{try{URL.revokeObjectURL(f.url)}catch{}m(C=>C.filter(x=>x.id!==f.id))},className:"absolute top-1 right-1 inline-flex items-center justify-center rounded-full bg-white p-1 text-red-600 shadow","aria-label":"Remove photo",children:e.jsx(xr,{className:"h-4 w-4 cursor-pointer"})})]},f.id))})]})},hr=({roomId:s,posts:r,users:t,showReplyFor:a,replyText:d,toggleReply:n,setReplyText:m,submitReply:c,currentUserId:_,creatorId:k,admins:f})=>{const[C,x]=L.useState(null),[w,S]=L.useState(null),[h,y]=L.useState({}),[V,p]=L.useState({}),[T,O]=L.useState({}),I=3,z=l=>O(D=>({...D,[l]:!D[l]})),M=ye(),X=async l=>{const D=!!_&&_===k,v=!!_&&!!f?.includes(_),F=!!_&&_===l.authorId,A=F,B=D||v,j=F||D;await Es({onEdit:A?()=>{x(l.id),y(U=>({...U,[l.id]:l.content}))}:void 0,onPin:B&&!l.pinned?()=>{M(Ue(l.id))}:void 0,onUnpin:B&&l.pinned?()=>{M(Ue(l.id))}:void 0,onDelete:j?()=>{M(As(l.id))}:void 0})},W=r.filter(l=>l.roomId===s).sort((l,D)=>new Date(D.createdAt).getTime()-new Date(l.createdAt).getTime());return W.length===0?e.jsx("div",{className:"flex items-center justify-center rounded-lg border border-gray-200 bg-white p-8",children:e.jsxs("div",{className:"max-w-md text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"No posts yet"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"This room doesn't have any posts yet."})]})}):e.jsx("div",{className:"space-y-4",children:W.map(l=>{const D=t.find(v=>v.id===l.authorId);return e.jsx("div",{className:"max-w-full overflow-hidden rounded-lg border border-gray-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("img",{src:D?.avatar,alt:D?.name,className:"h-10 w-10 rounded-full object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:e.jsx(ae,{to:`/profile/${D?.id}`,className:"cursor-pointer transition-colors hover:text-blue-600 hover:underline",children:D?.name||"Unknown"})}),e.jsxs("p",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsxs("span",{children:["@",D?.username||"username"]}),e.jsx("span",{className:"h-1 w-1 rounded-full bg-gray-400","aria-hidden":!0}),e.jsx("span",{children:ke(l.createdAt)}),e.jsx("span",{className:"h-1 w-1 rounded-full bg-gray-400","aria-hidden":!0}),e.jsx("span",{children:Re(l.createdAt)})]})]}),e.jsx("div",{className:"relative",children:e.jsx("button",{onClick:()=>X(l),className:"p-1 text-gray-500 hover:text-gray-800","aria-label":"Post menu",children:e.jsx(Te,{className:"h-5 w-5 cursor-pointer"})})})]}),C===l.id?e.jsxs("div",{className:"mt-2",children:[e.jsx("textarea",{className:"w-full rounded border border-gray-200 p-2 text-sm",rows:4,value:h[l.id]??l.content,onChange:v=>y(F=>({...F,[l.id]:v.target.value}))}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("button",{onClick:()=>{const v=(h[l.id]??l.content).trim();v&&M(ws({postId:l.id,content:v})),x(null)},className:"rounded bg-blue-600 px-3 py-1 text-sm font-medium text-white",children:"Save"}),e.jsx("button",{onClick:()=>x(null),className:"rounded border border-gray-300 px-3 py-1 text-sm",children:"Cancel"})]})]}):e.jsx("p",{className:"mt-2 text-justify break-words whitespace-pre-wrap text-gray-700",children:l.content}),l.attachments&&l.attachments.length>0&&e.jsx("div",{className:"mt-3",children:(()=>{const v=l.attachments.filter(A=>(A.mimeType||"").startsWith("image/")),F=l.attachments.filter(A=>!(A.mimeType||"").startsWith("image/"));return e.jsxs("div",{className:"space-y-2",children:[v.length>0&&e.jsx("div",{className:`grid gap-2 ${v.length===1?"grid-cols-1":v.length===2?"grid-cols-2":"grid-cols-3"}`,children:v.map(A=>e.jsx("a",{href:A.url,target:"_blank",rel:"noreferrer",className:"overflow-hidden rounded bg-gray-100",children:e.jsx("img",{src:A.url,alt:A.fileName,className:"h-36 w-full object-cover"})},A.id))}),F.length>0&&e.jsx("div",{className:"space-y-2",children:F.map(A=>e.jsxs("div",{className:"flex items-center justify-between rounded border border-gray-100 bg-gray-50 p-2 text-sm",children:[e.jsx("div",{className:"truncate text-gray-800",children:A.fileName}),e.jsxs("div",{className:"flex items-center gap-3",children:[A.url?e.jsx("a",{href:A.url,target:"_blank",rel:"noreferrer",className:"text-blue-600 hover:underline",children:"View"}):null,A.url?e.jsx("a",{download:A.fileName,href:A.url,className:"text-gray-600 hover:text-gray-800",children:"Download"}):null]})]},A.id))})]})})()}),e.jsx("div",{className:"mt-3 flex items-center gap-3",children:e.jsx("button",{onClick:()=>n(l.id),className:"cursor-pointer text-sm font-medium text-blue-600 hover:underline",children:"Reply"})}),a[l.id]&&e.jsxs("div",{className:"mt-2",children:[e.jsx("textarea",{value:d[l.id]||"",onChange:v=>m(F=>({...F,[l.id]:v.target.value})),className:"w-full rounded border border-gray-200 p-2 text-sm",rows:3}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("button",{onClick:()=>c(l.id),className:"rounded bg-blue-600 px-3 py-1 text-sm font-medium text-white",children:"Reply"}),e.jsx("button",{onClick:()=>n(l.id),className:"rounded border border-gray-300 px-3 py-1 text-sm",children:"Cancel"})]})]}),(l.replies?.length??0)>0&&(()=>{const v=l.replies||[],F=v.length,A=!!T[l.id],B=A?v:v.slice(0,I);return e.jsxs("div",{className:"mt-4 space-y-3",children:[B.map(j=>{const U=t.find(q=>q.id===j.authorId);return e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("img",{src:U?.avatar,alt:U?.name,className:"h-8 w-8 rounded-full object-cover"}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:U?e.jsx(ae,{to:`/profile/${U.id}`,className:"cursor-pointer transition-colors hover:text-blue-600 hover:underline",children:U.name}):j.authorId===_?"You":"Unknown"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("span",{children:ke(j.createdAt)}),e.jsx("span",{className:"mx-2",children:"â€¢"}),e.jsx("span",{children:Re(j.createdAt)})]})]})}),w&&w.postId===l.id&&w.replyId===j.id?e.jsxs("div",{className:"mt-1",children:[e.jsx("textarea",{className:"w-full rounded border border-gray-200 p-2 text-sm",rows:3,value:V[j.id]??j.content,onChange:q=>p(ee=>({...ee,[j.id]:q.target.value}))}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("button",{onClick:()=>{const q=(V[j.id]??j.content).trim();q&&M(Cs({postId:l.id,replyId:j.id,content:q})),S(null)},className:"rounded bg-blue-600 px-3 py-1 text-sm font-medium text-white",children:"Save"}),e.jsx("button",{onClick:()=>S(null),className:"rounded border border-gray-300 px-3 py-1 text-sm",children:"Cancel"})]})]}):e.jsxs("div",{children:[e.jsx("p",{className:"mt-1 text-justify text-sm break-words whitespace-pre-wrap text-gray-700",children:j.content}),e.jsx("div",{className:"mt-2 flex gap-3",children:(()=>{const q=!!_&&_===j.authorId,ee=!!_&&_===k,ue=q,he=q||ee;return e.jsxs(e.Fragment,{children:[ue?e.jsx("button",{onClick:()=>{S({postId:l.id,replyId:j.id}),p(ve=>({...ve,[j.id]:j.content}))},className:"cursor-pointer text-sm font-medium text-blue-600 hover:underline",children:"Edit"}):null,he?e.jsx("button",{onClick:()=>{M(ks({postId:l.id,replyId:j.id}))},className:"cursor-pointer text-sm font-medium text-red-600 hover:underline",children:"Delete"}):null]})})()})]})]})]},j.id)}),F>I&&e.jsx("div",{className:"mt-1",children:A?e.jsx("button",{onClick:()=>z(l.id),className:"text-sm font-medium text-gray-600 hover:underline",children:"Hide replies"}):e.jsxs("button",{onClick:()=>z(l.id),className:"text-sm font-medium text-gray-600 hover:underline",children:["View ",F-I," more repl",F-I===1?"y":"ies"]})})]})})()]})]})},l.id)})})},gr=({roomId:s,users:r,creatorId:t,admins:a,currentUserId:d,showReplyFor:n,replyText:m,toggleReply:c,setReplyText:_,submitReply:k})=>{const f=ye(),x=Z(it(s)).filter(l=>l.pinned).sort((l,D)=>new Date(D.createdAt).getTime()-new Date(l.createdAt).getTime()),[w,S]=L.useState(null),[h,y]=L.useState(null),[V,p]=L.useState({}),[T,O]=L.useState({}),[I,z]=L.useState({}),M=3,X=l=>z(D=>({...D,[l]:!D[l]})),W=async l=>{const D=!!d&&d===t,v=!!d&&!!a?.includes(d),F=!!d&&d===l.authorId;await Es({onEdit:F?()=>{S(l.id),p(U=>({...U,[l.id]:l.content}))}:void 0,onUnpin:D||v?()=>{f(Ue(l.id))}:void 0,onDelete:F||D?()=>{f(As(l.id))}:void 0})};return x.length===0?e.jsx("div",{className:"flex items-center justify-center rounded-lg border border-gray-200 bg-white p-8",children:e.jsxs("div",{className:"max-w-md text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"No pinned posts"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"There are currently no posts pinned in this room."})]})}):e.jsx("div",{className:"space-y-4",children:x.map(l=>{const D=r.find(v=>v.id===l.authorId);return e.jsx("div",{className:"max-w-full overflow-hidden rounded-lg border border-gray-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("img",{src:D?.avatar,alt:D?.name,className:"h-10 w-10 rounded-full object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:e.jsx(ae,{to:`/profile/${D?.id}`,className:"cursor-pointer transition-colors hover:text-blue-600 hover:underline",children:D?.name||"Unknown"})}),e.jsxs("p",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsxs("span",{children:["@",D?.username||"username"]}),e.jsx("span",{className:"h-1 w-1 rounded-full bg-gray-400","aria-hidden":!0}),e.jsx("span",{children:ke(l.createdAt)}),e.jsx("span",{className:"h-1 w-1 rounded-full bg-gray-400","aria-hidden":!0}),e.jsx("span",{children:Re(l.createdAt)})]})]}),e.jsx("div",{className:"relative",children:e.jsx("button",{onClick:()=>W(l),className:"p-1 text-gray-500 hover:text-gray-800","aria-label":"Post menu",children:e.jsx(Te,{className:"h-5 w-5"})})})]}),w===l.id?e.jsxs("div",{className:"mt-2",children:[e.jsx("textarea",{className:"w-full rounded border border-gray-200 p-2 text-sm",rows:4,value:V[l.id]??l.content,onChange:v=>p(F=>({...F,[l.id]:v.target.value}))}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("button",{onClick:()=>{const v=(V[l.id]??l.content).trim();v&&f(ws({postId:l.id,content:v})),S(null)},className:"rounded bg-blue-600 px-3 py-1 text-sm font-medium text-white",children:"Save"}),e.jsx("button",{onClick:()=>S(null),className:"rounded border border-gray-300 px-3 py-1 text-sm",children:"Cancel"})]})]}):e.jsx("p",{className:"mt-2 text-justify break-words whitespace-pre-wrap text-gray-700",children:l.content}),l.attachments&&l.attachments.length>0&&e.jsx("div",{className:"mt-3",children:(()=>{const v=l.attachments.filter(A=>(A.mimeType||"").startsWith("image/")),F=l.attachments.filter(A=>!(A.mimeType||"").startsWith("image/"));return e.jsxs("div",{className:"space-y-2",children:[v.length>0&&e.jsx("div",{className:`grid gap-2 ${v.length===1?"grid-cols-1":v.length===2?"grid-cols-2":"grid-cols-3"}`,children:v.map(A=>e.jsx("a",{href:A.url,target:"_blank",rel:"noreferrer",className:"overflow-hidden rounded bg-gray-100",children:e.jsx("img",{src:A.url,alt:A.fileName,className:"h-36 w-full object-cover"})},A.id))}),F.length>0&&e.jsx("div",{className:"space-y-2",children:F.map(A=>e.jsxs("div",{className:"flex items-center justify-between rounded border border-gray-100 bg-gray-50 p-2 text-sm",children:[e.jsx("div",{className:"truncate text-gray-800",children:A.fileName}),e.jsxs("div",{className:"flex items-center gap-3",children:[A.url?e.jsx("a",{href:A.url,target:"_blank",rel:"noreferrer",className:"text-blue-600 hover:underline",children:"View"}):null,A.url?e.jsx("a",{download:A.fileName,href:A.url,className:"text-gray-600 hover:text-gray-800",children:"Download"}):null]})]},A.id))})]})})()}),e.jsx("div",{className:"mt-3 flex items-center gap-3",children:e.jsx("button",{onClick:()=>c(l.id),className:"cursor-pointer text-sm font-medium text-blue-600 hover:underline",children:"Reply"})}),n[l.id]&&e.jsxs("div",{className:"mt-2",children:[e.jsx("textarea",{value:m[l.id]||"",onChange:v=>_(F=>({...F,[l.id]:v.target.value})),className:"w-full rounded border border-gray-200 p-2 text-sm",rows:3}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("button",{onClick:()=>k(l.id),className:"rounded bg-blue-600 px-3 py-1 text-sm font-medium text-white",children:"Reply"}),e.jsx("button",{onClick:()=>c(l.id),className:"rounded border border-gray-300 px-3 py-1 text-sm",children:"Cancel"})]})]}),(l.replies?.length??0)>0&&(()=>{const v=l.replies||[],F=v.length,A=!!I[l.id],B=A?v:v.slice(0,M);return e.jsxs("div",{className:"mt-4 space-y-3",children:[B.map(j=>{const U=r.find(q=>q.id===j.authorId);return e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("img",{src:U?.avatar,alt:U?.name,className:"h-8 w-8 rounded-full object-cover"}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:U?e.jsx(ae,{to:`/profile/${U.id}`,className:"cursor-pointer transition-colors hover:text-blue-600 hover:underline",children:U.name}):j.authorId===d?"You":"Unknown"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("span",{children:ke(j.createdAt)}),e.jsx("span",{className:"mx-2",children:"â€¢"}),e.jsx("span",{children:Re(j.createdAt)})]})]})}),h&&h.postId===l.id&&h.replyId===j.id?e.jsxs("div",{className:"mt-1",children:[e.jsx("textarea",{className:"w-full rounded border border-gray-200 p-2 text-sm",rows:3,value:T[j.id]??j.content,onChange:q=>O(ee=>({...ee,[j.id]:q.target.value}))}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("button",{onClick:()=>{const q=(T[j.id]??j.content).trim();q&&f(Cs({postId:l.id,replyId:j.id,content:q})),y(null)},className:"rounded bg-blue-600 px-3 py-1 text-sm font-medium text-white",children:"Save"}),e.jsx("button",{onClick:()=>y(null),className:"rounded border border-gray-300 px-3 py-1 text-sm",children:"Cancel"})]})]}):e.jsxs("div",{children:[e.jsx("p",{className:"mt-1 text-justify text-sm break-words whitespace-pre-wrap text-gray-700",children:j.content}),e.jsx("div",{className:"mt-2 flex gap-3",children:(()=>{const q=!!d&&d===j.authorId,ee=!!d&&d===t,ue=q,he=q||ee;return e.jsxs(e.Fragment,{children:[ue?e.jsx("button",{onClick:()=>{y({postId:l.id,replyId:j.id}),O(ve=>({...ve,[j.id]:j.content}))},className:"cursor-pointer text-sm font-medium text-blue-600 hover:underline",children:"Edit"}):null,he?e.jsx("button",{onClick:()=>{f(ks({postId:l.id,replyId:j.id}))},className:"cursor-pointer text-sm font-medium text-red-600 hover:underline",children:"Delete"}):null]})})()})]})]})]},j.id)}),F>M&&e.jsx("div",{className:"mt-1",children:A?e.jsx("button",{onClick:()=>X(l.id),className:"text-sm font-medium text-gray-600 hover:underline",children:"Hide replies"}):e.jsxs("button",{onClick:()=>X(l.id),className:"text-sm font-medium text-gray-600 hover:underline",children:["View ",F-M," more repl",F-M===1?"y":"ies"]})})]})})()]})]})},l.id)})})},br=({roomId:s,users:r,onAccept:t,onDecline:a,onAddFriend:d,onCancelRequest:n,onUnfriend:m,currentUser:c,onRemoveMember:_,onMakeAdmin:k,onRemoveAdmin:f})=>{const C=Z(p=>p.friends.friendships),x=Z(p=>p.friends.friendRequests),w=Z(p=>p.classRoom.members.filter(T=>T.roomId===s)),h=w.find(p=>p.role==="creator")?.userId,y=w.filter(p=>p.role==="admin"||p.role==="creator").map(p=>p.userId),V=async(p,T,O)=>{const I=!!c&&!!h&&c.id===h,z=I,M=!!c&&!!y&&y.includes(c.id);await It(T??"Member",{onRemove:I||M&&!O?()=>{_&&_(p)}:void 0,onMakeAdmin:z&&!O?()=>{if(!c||c.id!==h){ls({title:"Not allowed",text:"Only the room creator can change admin status."});return}k&&k(p)}:void 0,onRemoveAdmin:z&&O?()=>{if(!c||c.id!==h){ls({title:"Not allowed",text:"Only the room creator can change admin status."});return}f&&f(p)}:void 0})};return e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Members (",w?.length||0,")"]}),e.jsx("div",{className:"mt-3 space-y-2.5",children:w&&w.length>0?w.map(p=>{const T=r.find(j=>j.id===p.userId);if(!T)return null;const O=c?C.some(j=>j.user1Id===c.id&&j.user2Id===T.id||j.user1Id===T.id&&j.user2Id===c.id):!1,I=c?x.some(j=>j.status==="pending"&&j.senderId===T.id&&j.receiverId===c.id):!1,z=c?x.some(j=>j.status==="pending"&&j.senderId===c.id&&j.receiverId===T.id):!1;let M="search";c&&p.userId===c.id?M="search":O?M="friend":I?M="request":z?M="sent":M="suggestion";const W=T.educationLevel==="UNIVERSITY"?T.university?.name:T.college?.name,l=!!y&&y.includes(T.id),D=!!h&&T.id===h,v=!!c&&!!h&&c.id===h,F=!!c&&!!y&&y.includes(c.id),A=(v||F)&&T.id!==h&&T.id!==c?.id;let B="";return D&&l?B=" â€¢ Owner â€¢ Admin":D?B=" â€¢ Owner":l&&(B=" â€¢ Admin"),e.jsx(Mt,{id:T.id,name:T.name,avatar:T.avatar,university:(W||"Unknown Institution")+B,type:M,onAccept:t,onDecline:a,onAddFriend:d,onCancelRequest:n,onUnfriend:m,menuElement:A?e.jsx("button",{onClick:()=>V(T.id,T.name,l),className:"p-1 text-gray-500 hover:text-gray-800","aria-label":"Member menu",children:e.jsx(Te,{className:"h-5 w-5"})}):void 0},T.id)}):null})]})},yr=[{id:"f-r1-1",roomId:"r1",fileName:"Calculus_Notes_Chapter1.pdf",url:"https://example.com/files/calculus-ch1.pdf",uploadedBy:"1",createdAt:"2025-01-03T09:00:00.000Z",sizeKb:256,mimeType:"application/pdf",isGeneral:!0},{id:"f-r1-2",roomId:"r1",fileName:"Limits_ClassTest.pdf",url:"https://example.com/files/limits-ct.pdf",uploadedBy:"4",createdAt:"2025-01-05T14:30:00.000Z",sizeKb:128,mimeType:"application/pdf",isCT:!0},{id:"f-r1-3",roomId:"r1",fileName:"Homework_Assignment_1.zip",url:"https://example.com/files/hw1.zip",uploadedBy:"9",createdAt:"2025-01-07T18:45:00.000Z",sizeKb:1024,mimeType:"application/zip",isAssignment:!0},{id:"f-r2-1",roomId:"r2",fileName:"React_Tips.pdf",url:"https://example.com/files/react-tips.pdf",uploadedBy:"11",createdAt:"2025-02-02T10:00:00.000Z",sizeKb:512,mimeType:"application/pdf",isGeneral:!0},{id:"f-r2-2",roomId:"r2",fileName:"Midterm_ClassTest.docx",url:"https://example.com/files/midterm.docx",uploadedBy:"7",createdAt:"2025-02-10T09:15:00.000Z",sizeKb:64,mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",isCT:!0},{id:"f-r3-1",roomId:"r3",fileName:"Session_Recordings.zip",url:"https://example.com/files/session-recordings.zip",uploadedBy:"3",createdAt:"2025-03-02T20:00:00.000Z",sizeKb:2048,mimeType:"application/zip",isGeneral:!0}],vr=({roomId:s,creatorId:r,admins:t,currentUserId:a})=>{const[d,n]=L.useState("general"),[m,c]=L.useState(()=>yr.filter(S=>S.roomId===s)),_=m.filter(S=>d==="general"?!!S.isGeneral:d==="ct"?!!S.isCT:!!S.isAssignment),k={general:m.filter(S=>S.isGeneral).length,ct:m.filter(S=>S.isCT).length,assignments:m.filter(S=>S.isAssignment).length},f=async S=>{await Vt(S.fileName,{onRename:h=>{c(y=>y.map(V=>V.id===S.id?{...V,fileName:h}:V))},onDelete:()=>{c(h=>h.filter(y=>y.id!==S.id))}})},C=L.useRef(null),x=!!a&&(a===r||!!t?.includes(a)),w=S=>{const h=S.target.files?.[0];if(!h)return;const y=URL.createObjectURL(h),V={id:`f-${s}-${Date.now()}`,roomId:s,fileName:h.name,url:y,uploadedBy:ne[0]?.id??"1",createdAt:new Date().toISOString(),sizeKb:Math.round(h.size/1024),mimeType:h.type,isGeneral:d==="general",isCT:d==="ct",isAssignment:d==="assignments"};c(p=>[V,...p]),C.current&&(C.current.value="")};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 border-b border-gray-200 pb-2",children:[e.jsxs("button",{onClick:()=>n("general"),className:`rounded px-3 py-2 text-sm font-medium ${d==="general"?"bg-blue-50 text-blue-700":"text-gray-600 hover:bg-gray-50"}`,children:["General (",k.general,")"]}),e.jsxs("button",{onClick:()=>n("ct"),className:`rounded px-3 py-2 text-sm font-medium ${d==="ct"?"bg-blue-50 text-blue-700":"text-gray-600 hover:bg-gray-50"}`,children:["Class Test (",k.ct,")"]}),e.jsxs("button",{onClick:()=>n("assignments"),className:`rounded px-3 py-2 text-sm font-medium ${d==="assignments"?"bg-blue-50 text-blue-700":"text-gray-600 hover:bg-gray-50"}`,children:["Assignments (",k.assignments,")"]}),e.jsxs("div",{className:"ml-auto",children:[e.jsx("input",{ref:C,type:"file",className:"hidden",onChange:w,"aria-hidden":!0}),x?e.jsx("button",{onClick:()=>C.current?.click(),className:"rounded-md border border-blue-100 bg-blue-50 px-3 py-1 text-sm font-medium text-blue-700 hover:bg-blue-100",children:"Upload"}):e.jsx("div",{className:"text-sm text-gray-500",children:"Only admins can upload"})]})]}),e.jsx("div",{className:"mt-4 space-y-3",children:_.length===0?e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-6 text-center",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"No files"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"There are no files in this category yet."})]}):_.map(S=>{const h=ne.find(p=>p.id===S.uploadedBy),y=S.fileName.match(/\.([0-9a-zA-Z]+)$/),V=y?y[1].toUpperCase():"FILE";return e.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-gray-200 bg-white p-3",children:[e.jsxs("div",{className:"flex min-w-0 items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded bg-blue-50 font-semibold text-blue-700",children:V}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate font-medium text-gray-900",style:{maxWidth:420},children:S.fileName}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("span",{children:h?.name??"Unknown"}),e.jsx("span",{className:"mx-2",children:"â€¢"}),e.jsx("span",{children:ke(S.createdAt)}),S.sizeKb?e.jsx("span",{className:"mx-2",children:"â€¢"}):null,S.sizeKb?e.jsxs("span",{children:[S.sizeKb," KB"]}):null]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[S.url&&e.jsxs("a",{href:S.url,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 rounded-md border border-blue-100 bg-blue-50 px-3 py-1 text-sm font-medium text-blue-700 transition hover:bg-blue-100",children:[e.jsx(at,{className:"h-3 w-3"}),"View"]}),S.url&&e.jsxs("a",{download:S.fileName,href:S.url,className:"inline-flex items-center gap-2 rounded-md border border-gray-100 bg-gray-50 px-3 py-1 text-sm font-medium text-gray-700 transition hover:bg-gray-100",children:[e.jsx(nt,{className:"h-3 w-3"}),"Download"]}),x&&e.jsx("button",{onClick:()=>f(S),className:"p-1 text-gray-500 hover:text-gray-800","aria-label":"File menu",children:e.jsx(Te,{className:"h-5 w-5"})})]})]},S.id)})})]})},pr=({room:s,creator:r,admins:t=[],memberCount:a=0,users:d,currentUserId:n,roomId:m,onDeleteRoom:c})=>{const _=async()=>{!m||!c||!await $e({title:"Delete room?",text:"This will mark the room as deleted and remove it from lists.",confirmButtonText:"Delete",icon:"warning"})||c(m)},k=!!r?.id&&!!n&&r.id===n;return e.jsxs("div",{className:"space-y-6",children:[r&&e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 font-bold text-gray-900",children:"Creator"}),e.jsxs("div",{className:"flex items-center gap-3 rounded-lg border border-gray-200 bg-gray-50 p-3",children:[e.jsx("img",{src:r.avatar||"https://via.placeholder.com/48",alt:r.name,className:"h-12 w-12 rounded-full object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(ae,{to:`/profile/${r.id}`,className:"font-semibold text-gray-900 hover:text-blue-600 hover:underline",children:r.name}),r.username&&e.jsxs("p",{className:"text-sm text-gray-500",children:["@",r.username]})]}),e.jsx("span",{className:"rounded-full bg-blue-100 px-3 py-1 text-xs font-medium text-blue-700",children:"Creator"})]})]}),t.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"mb-3 font-bold text-gray-900",children:["Admins (",t.length,")"]}),e.jsx("div",{className:"space-y-2",children:t.map(f=>{const C=d.find(w=>w.id===f);if(!C)return null;const x=f===r?.id;return e.jsxs("div",{className:"flex items-center gap-3 rounded-lg border border-gray-200 bg-gray-50 p-3",children:[e.jsx("img",{src:C.avatar,alt:C.name,className:"h-12 w-12 rounded-full object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(ae,{to:`/profile/${C.id}`,className:"font-semibold text-gray-900 hover:text-blue-600 hover:underline",children:C.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["@",C.username]})]}),e.jsxs("div",{className:"flex gap-2",children:[x&&e.jsx("span",{className:"rounded-full bg-blue-100 px-3 py-1 text-xs font-medium text-blue-700",children:"Creator"}),e.jsx("span",{className:"rounded-full bg-purple-100 px-3 py-1 text-xs font-medium text-purple-700",children:"Admin"})]})]},f)})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 font-bold text-gray-900",children:"Room Stats"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a}),e.jsx("p",{className:"text-sm text-gray-600",children:"Members"})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Admins"})]})]})]}),(s.university||s.department||s.year||s.semester)&&e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 font-bold text-gray-900",children:"Room Details"}),e.jsxs("div",{className:"space-y-2 rounded-lg border border-gray-200 bg-gray-50 p-4",children:[s.university&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"University:"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.university})]}),s.department&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Department:"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.department})]}),s.year&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Year:"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.year})]}),s.semester&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Semester:"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.semester})]}),s.section&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Section:"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.section})]}),s.subsection&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Subsection:"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.subsection})]})]})]}),s.createdAt&&e.jsxs("div",{children:[e.jsx("h3",{className:"mb-2 font-bold text-gray-900",children:"Created"}),e.jsx("p",{className:"text-gray-700",children:new Date(s.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),s.lastActivityAt&&e.jsxs("div",{children:[e.jsx("h3",{className:"mb-2 font-bold text-gray-900",children:"Last Activity"}),e.jsx("p",{className:"text-gray-700",children:new Date(s.lastActivityAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),k&&c&&e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsx("h3",{className:"mb-3 font-bold text-red-600",children:"Danger Zone"}),e.jsx("button",{onClick:_,className:"rounded-lg bg-red-600 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-red-700",children:"Delete Room"}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"This action cannot be undone. The room will be permanently deleted."})]})]})},jr=()=>{const{roomId:s}=Ss(),r=Z(l=>l.classRoom.rooms.find(D=>D.id===s)),t=Fs.find(l=>l.id===s),a=r||t,[d,n]=L.useState(a?{...a}:void 0),[m,c]=L.useState("posts"),_=[{id:"posts",label:"Posts",icon:xt},{id:"pinned",label:"Pinned",icon:ft},{id:"members",label:"Members",icon:as},{id:"media",label:"Files",icon:ht},{id:"about",label:"About",icon:gt}],k=ye(),f=Z(l=>De(l,l.profile.id)),C=lt(),x=Z(l=>a?ot(l,a.id):void 0),w=Z(l=>a?dt(l,a.id):0),S=Z(l=>a?ct(l,a.id):[]),h=Z(l=>a&&f?ut(l,f.id,a.id):!1),y=x?ne.find(l=>l.id===x):void 0;Q.useEffect(()=>{a&&n({...a})},[a]);const[V,p]=L.useState({}),[T,O]=L.useState({}),[I,z]=L.useState(!1),M=Z(l=>l.roomPosts?.posts||mt),X=l=>p(D=>({...D,[l]:!D[l]})),W=l=>{const D=(T[l]||"").trim();if(!D)return;const v={id:`reply-${l}-${Date.now()}`,authorId:f?.id,content:D,createdAt:new Date().toISOString()};k(kt({postId:l,reply:v})),O(F=>({...F,[l]:""})),p(F=>({...F,[l]:!1}))};return a?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"rounded-lg border border-gray-300 bg-white p-3 shadow-sm",children:e.jsxs("div",{className:"grid grid-cols-[auto_1fr_auto] gap-3",children:[e.jsx("img",{src:a.coverImage||`https://picsum.photos/seed/${a.id}/600/300`,alt:a.name,className:"h-36 w-64 rounded object-cover"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:a.name}),y&&e.jsx("div",{className:"mt-1",children:e.jsx("div",{className:"font-semibold text-gray-900",children:e.jsx(ae,{to:`/profile/${y.id}`,className:"cursor-pointer transition-colors hover:text-blue-600 hover:underline",children:y.name})})}),e.jsxs("p",{className:"mt-2 flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(as,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"font-medium",children:[w," members"]})]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-end gap-2",children:[f?.id&&h?e.jsx("button",{onClick:()=>C(`/classroom/rooms/${a.id}/live`),className:"w-full rounded bg-green-600 px-3 py-1 text-sm font-medium text-white hover:bg-green-700",children:"Go live"}):null,e.jsx("button",{onClick:()=>{c("posts"),z(!0)},className:"w-full rounded bg-blue-600 px-3 py-1 text-sm font-medium text-white hover:bg-blue-700",children:"Create post"})]})]})}),e.jsx("div",{}),I&&e.jsx("div",{className:"mt-3",children:e.jsx(fr,{roomId:a.id,currentUserId:f?.id,onClose:()=>z(!1)})}),e.jsxs("div",{className:"mx-auto max-w-5xl rounded-lg bg-white shadow",children:[e.jsx("div",{className:"border-b border-gray-200 bg-white",children:e.jsx("div",{className:"flex justify-between px-3",children:_.map(l=>e.jsxs("button",{onClick:()=>c(l.id),className:`flex items-center gap-2 border-b-2 px-6 py-4 font-semibold transition-colors ${m===l.id?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[e.jsx(l.icon,{className:"h-5 w-5"}),l.label]},l.id))})}),e.jsxs("div",{className:"p-3",children:[m==="posts"&&e.jsx("div",{className:"space-y-3",children:e.jsx(hr,{roomId:d?.id||a.id,posts:M,users:ne,showReplyFor:V,replyText:T,toggleReply:X,setReplyText:O,submitReply:W,currentUserId:f?.id,creatorId:x,admins:S})}),m==="pinned"&&e.jsx(gr,{roomId:d?.id||a.id,users:ne,creatorId:x,admins:S,currentUserId:f?.id,showReplyFor:V,replyText:T,toggleReply:X,setReplyText:O,submitReply:W}),m==="members"&&e.jsx(br,{roomId:a.id,users:ne,currentUser:f,onAccept:l=>k(Ct({senderId:l,receiverId:f?.id||""})),onDecline:l=>k(wt({senderId:l,receiverId:f?.id||""})),onAddFriend:l=>k(Nt({senderId:f?.id||"",receiverId:l})),onCancelRequest:l=>k(jt({senderId:f?.id||"",receiverId:l})),onUnfriend:async l=>{await $e({title:"Are you sure?",text:"You will remove this friend.",confirmButtonText:"Yes, unfriend",icon:"warning"})&&k(pt({user1Id:f?.id||"",user2Id:l}))},onRemoveMember:async l=>{await $e({title:"Remove member?",text:"This user will be removed from the room.",confirmButtonText:"Yes, remove",icon:"warning"})&&k(vt({userId:l,roomId:a.id}))},onMakeAdmin:l=>{k(yt({userId:l,roomId:a.id}))},onRemoveAdmin:l=>{k(bt({userId:l,roomId:a.id}))}}),m==="media"&&e.jsx(vr,{roomId:a.id,creatorId:x,admins:S,currentUserId:f?.id}),m==="about"&&e.jsx(pr,{room:d||a,creator:y?{id:y.id,name:y.name,username:y.username,avatar:y.avatar}:void 0,admins:S,memberCount:w,users:ne,currentUserId:f?.id,roomId:a.id,onDeleteRoom:()=>{d&&n({...d,isDeleted:!0}),k(Rs({...d||a,isDeleted:!0})),C("/classroom")}})]})]})]}):e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-8 text-center shadow-sm",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Room Not Found"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"The room you're looking for doesn't exist or has been removed."}),e.jsx("div",{className:"mt-4",children:e.jsx(ae,{to:"/classroom",className:"text-blue-600 hover:underline",children:"Back to Rooms"})})]})};var Fe={exports:{}},Nr=Fe.exports,js;function wr(){return js||(js=1,(function(s,r){(function(t,a){s.exports=a()})(Nr,(function(){return function(t,a,d){t=t||{};var n=a.prototype,m={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function c(k,f,C,x){return n.fromToBase(k,f,C,x)}d.en.relativeTime=m,n.fromToBase=function(k,f,C,x,w){for(var S,h,y,V=C.$locale().relativeTime||m,p=t.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],T=p.length,O=0;O<T;O+=1){var I=p[O];I.d&&(S=x?d(k).diff(C,I.d,!0):C.diff(k,I.d,!0));var z=(t.rounding||Math.round)(Math.abs(S));if(y=S>0,z<=I.r||!I.r){z<=1&&O>0&&(I=p[O-1]);var M=V[I.l];w&&(z=w(""+z)),h=typeof M=="string"?M.replace("%d",z):M(z,f,I.l,y);break}}if(f)return h;var X=y?V.future:V.past;return typeof X=="function"?X(h):X.replace("%s",h)},n.to=function(k,f){return c(k,f,this,!0)},n.from=function(k,f){return c(k,f,this)};var _=function(k){return k.$u?d.utc():d()};n.toNow=function(k){return this.to(_(this),k)},n.fromNow=function(k){return this.from(_(this),k)}}}))})(Fe)),Fe.exports}var Cr=wr();const kr=At(Cr),Ar=()=>{const{roomId:s}=Ss(),r=Fs.find(y=>y.id===s),t=Z(y=>De(y,y.profile.id)),a=r?St(r.id):void 0,d=L.useMemo(()=>{if(a)return ne.find(y=>y.id===a)},[a]),[n,m]=L.useState(!1),[c,_]=L.useState(()=>r?ns(r.id):[]),[k,f]=L.useState([]),[C,x]=L.useState("");if(L.useEffect(()=>{if(!r)return;const y=ns(r.id);_(y)},[r]),L.useEffect(()=>{Ne.extend(kr)},[]),!r)return e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-8 text-center shadow-sm",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Live not found"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"This live session does not exist."}),e.jsx("div",{className:"mt-4",children:e.jsx(ae,{to:"/classroom",className:"text-blue-600 hover:underline",children:"Back to Rooms"})})]});if(!(t?.id&&Ft(t.id,r.id)))return e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-8 text-center shadow-sm",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Access Denied"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Only room admins can access the live session."}),e.jsx("div",{className:"mt-4",children:e.jsx(ae,{to:`/classroom/rooms/${r.id}`,className:"text-blue-600 hover:underline",children:"Back to Room"})})]});const S=()=>{m(y=>!y),f(y=>[...y,{id:`sys-${Date.now()}`,content:`${n?"Live ended":"Live started"} by ${t?.name??"host"}`,createdAt:new Date().toISOString()}])},h=()=>{const y=C.trim();y&&(f(V=>[...V,{id:`m-${Date.now()}`,authorId:t?.id,content:y,createdAt:new Date().toISOString()}]),x(""))};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-lg border border-gray-300 bg-white p-3 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:r.name}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Host: ",d?d.name:"Unknown"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`rounded px-2 py-1 text-sm font-medium ${n?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:n?"Live":"Offline"}),t?.id===a?e.jsx("button",{onClick:S,className:`rounded px-3 py-1 text-sm font-medium text-white ${n?"bg-gray-600 hover:bg-gray-700":"bg-red-600 hover:bg-red-700"}`,children:n?"End live":"Start live"}):null]})]}),e.jsxs("div",{className:"mt-4 flex flex-col gap-4 lg:flex-row",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"relative flex aspect-video min-h-[240px] w-full items-center justify-center overflow-hidden rounded bg-black text-white",children:n?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-semibold",children:"Live stream"}),e.jsx("div",{className:"text-sm text-gray-200",children:"(streaming placeholder)"})]}):e.jsx("div",{className:"text-center text-gray-300",children:"Live is not started yet"})})}),e.jsx("div",{className:"mt-2 w-full lg:mt-0 lg:w-80",children:e.jsxs("div",{className:"rounded border border-gray-200 bg-white p-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Participants"}),e.jsx("div",{className:"mt-2 max-h-56 space-y-2 overflow-auto",children:c.map(y=>{const V=ne.find(p=>p.id===y);return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:V?.avatar,alt:V?.name,className:"h-8 w-8 rounded-full object-cover"}),e.jsx("div",{className:"text-sm text-gray-700",children:V?.name??y})]},y)})})]})})]})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-3 shadow-sm",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Live chat"}),e.jsxs("div",{className:"mt-3 flex h-72 flex-col lg:h-80",children:[e.jsx("div",{className:"mb-3 flex-1 space-y-2 overflow-auto",children:k.length===0?e.jsx("div",{className:"text-sm text-gray-500",children:"No messages yet"}):k.map(y=>{const V=y.authorId?ne.find(p=>p.id===y.authorId):void 0;return e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-800",children:V?.name??"System"}),e.jsx("div",{className:"text-xs text-gray-400",children:Ne(y.createdAt).fromNow()})]}),e.jsx("div",{className:"text-sm text-gray-700",children:y.content})]},y.id)})}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx("input",{value:C,onChange:y=>x(y.target.value),onKeyDown:y=>y.key==="Enter"&&h(),className:"w-full rounded border border-gray-300 px-3 py-2 text-sm",placeholder:"Type a message..."}),e.jsx("button",{onClick:h,disabled:!C.trim(),className:"rounded bg-blue-600 px-3 py-2 text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-50",children:"Send"})]})]})]})]})},Dr=()=>{const s=ye(),[r,t]=Q.useState(!1),a=()=>t(!0),d=()=>t(!1),n=c=>{const _=`room_${Date.now()}`,k=Tt(),f={id:_,name:c.name,university:c.university,department:c.department,year:c.year,semester:c.semester,section:c.section,subsection:c.subsection||void 0,createdAt:Ne().toISOString(),lastActivityAt:Ne().toISOString()};s(Rs(f)),s(Dt({id:`member_${Date.now()}`,userId:k,roomId:_,role:"creator",joinedAt:Ne().toISOString(),status:"open"})),t(!1)},m=Rt({path:"/classroom",end:!0});return e.jsxs("div",{className:"space-y-5",children:[e.jsx(Lt,{onOpenCreate:a,showCreate:!!m}),e.jsx(Pt,{}),e.jsx("div",{className:"grid grid-cols-1 gap-5 lg:grid-cols-1",children:e.jsx("main",{children:e.jsxs(Et,{children:[e.jsx(pe,{index:!0,element:e.jsx(ur,{showCreateForm:r,onCreate:n,onCancelCreate:d})}),e.jsx(pe,{path:"more",element:e.jsx(mr,{})}),e.jsx(pe,{path:"rooms/:roomId",element:e.jsx(jr,{})}),e.jsx(pe,{path:"rooms/:roomId/live",element:e.jsx(Ar,{})}),e.jsx(pe,{path:"*",element:e.jsx(_t,{to:".",replace:!0})})]})})})]})};export{Dr as default};
